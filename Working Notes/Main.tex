\documentclass[12pt]{amsart}
\usepackage{amstext,amsfonts,amssymb,amscd,amsbsy,amsmath,verbatim, mathrsfs, fullpage}
\usepackage[alphabetic,abbrev,lite]{amsrefs} % for bibliography 
\usepackage{ifthen,tikz}
\usepackage{color}
\usepackage{amsthm}
\usepackage{latexsym}
\usepackage[all]{xy}
\usepackage{enumerate}
\usepackage{mathtools}

\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}



\newtheorem{lemma}{Lemma}[section]
\newtheorem{theorem}[lemma]{Theorem}
\newtheorem{propo}[lemma]{Proposition}
\newtheorem{prop}[lemma]{Proposition}
\newtheorem{cor}[lemma]{Corollary}
\newtheorem{conj}[lemma]{Conjecture}
\newtheorem{claim}[lemma]{Claim}
\newtheorem{claim*}{Claim}
\newtheorem{thm}[lemma]{Theorem}
\newtheorem{notation}[lemma]{Notation}
\newtheorem{question}[lemma]{Question}


\theoremstyle{definition}
\newtheorem{defn}[lemma]{Definition}
\newtheorem{example}[lemma]{Example}
\newtheorem{warning}[lemma]{Warning}

\theoremstyle{remark}
\newtheorem{remark}[lemma]{Remark}
\newtheorem{rem}[lemma]{Remark}


% Commands

\newcommand{\Kos}{\mathcal{K}}
\newcommand{\cS}{\mathcal{S}}
\newcommand{\rC}{\mathrm{C}}
\newcommand{\Cech}{\check{\mathrm{C}}}
\newcommand{\Tate}{{\mathbf{T}}}
\newcommand{\Tail}{{\mathbf{Tail}}}
\newcommand{\cC}{\mathcal{C}}
\newcommand{\cK}{\mathcal{K}}
\newcommand{\tot}{\operatorname{tot}}

\newcommand{\isom}{\cong}
\newcommand{\m}{\mathfrak m}
\newcommand{\PP}{\mathbb P}
\newcommand{\bD}{\mathbf D}
\newcommand{\df}{\operatorname{diff}}
\renewcommand{\P}{\PP}
\newcommand{\bA}{\mathbb A}
\newcommand{\A}{\bA}
\newcommand{\HH}{\mathrm H}
\newcommand{\GG}{\mathbb G}
\newcommand{\ZZ}{\mathbb Z}
\newcommand{\QQ}{\mathbb Q}
\newcommand{\bH}{\mathbf H}
\newcommand{\bF}{\mathbf F}
\newcommand{\DD}{\mathbf D}
\newcommand{\lideal}{\langle}
\newcommand{\rideal}{\rangle}
\newcommand{\initial}{\operatorname{in}}
\newcommand{\Hilb}{\operatorname{Hilb}}
\newcommand{\Spec}{\operatorname{Spec}}
\newcommand{\NE}{\overline{\operatorname{NE}}}
\newcommand{\Eff}{\operatorname{Eff}}
\newcommand{\im}{\operatorname{im}}
\newcommand{\NS}{\operatorname{NS}}
\newcommand{\Frac}{\operatorname{Frac}}
\newcommand{\ch}{\operatorname{char}}
\newcommand{\Proj}{\operatorname{Proj}}
\newcommand{\id}{\operatorname{id}}
\newcommand{\Div}{\operatorname{Div}}
\newcommand{\tr}{\operatorname{tr}}
\newcommand{\Tr}{\operatorname{Tr}}
\newcommand{\Supp}{\operatorname{Supp}}
\newcommand{\Gal}{\operatorname{Gal}}
\newcommand{\Pic}{\operatorname{Pic}}
\newcommand{\QQbar}{{\overline{\mathbb Q}}}
\newcommand{\Br}{\operatorname{Br}}
\newcommand{\Bl}{\operatorname{Bl}}
\newcommand{\Cox}{\operatorname{Cox}}
\newcommand{\Tor}{\operatorname{Tor}}
\newcommand{\diam}{\operatorname{diam}}
\newcommand{\Hom}{\operatorname{Hom}} %done
\newcommand{\sheafHom}{\mathcal{H}om}
\newcommand{\Gr}{\operatorname{Gr}}
\newcommand{\HF}{\operatorname{HF}}
\newcommand{\HP}{\operatorname{HP}}
\newcommand{\Osh}{{\mathcal O}}
\newcommand{\cO}{{\mathcal O}}
\newcommand{\kk}{{\bf k}}
\newcommand{\rank}{\operatorname{rank}}
\newcommand{\length}{\operatorname{length}}
\newcommand{\codim}{\operatorname{codim}}
\newcommand{\depth}{\operatorname{depth}}
%\newcommand{\FF}{\mathbb{F}}
\newcommand{\F}{\FF}
\newcommand{\Sym}{\operatorname{Sym}} %done
\newcommand{\GL}{{GL}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\CC}{\mathbb{C}}
\newcommand{\Syz}{\operatorname{Syz}}
\newcommand{\Prob}{\operatorname{Prob}}
\newcommand{\defi}[1]{\textsf{#1}} % for defined terms
\newcommand{\Htot}{H_{\tot}}
\newcommand{\Ltot}{L_{\tot}}
\newcommand{\beq}{\begin{displaymath}}
\newcommand{\eeq}{\end{displaymath}}
\newcommand{\bs}{\backslash}
\newcommand{\ff}{\mathbf{f}}
\newcommand{\Gam}{\Gamma}
\def\matrix{
	\begin{pmatrix}
	0 & 0 \\
	e_0 & 0 \\
	\end{pmatrix}
	}


\newcommand{\Bmod}{\ensuremath{B_\text{mod}}}
\newcommand{\Bint}{\ensuremath{B_\text{int}}}
\newcommand\commentr[1]{{\color{red} \sf [#1]}}
\newcommand\commentb[1]{{\color{blue} \sf [#1]}}
\newcommand\commentm[1]{{\color{magenta} \sf [#1]}}
\newcommand{\daniel}[1]{{\color{blue} \sf $\clubsuit\clubsuit\clubsuit$ Daniel: [#1]}}
\newcommand{\michael}[1]{{\color{red} \sf $\clubsuit\clubsuit\clubsuit$ Michael: [#1]}}
\newcommand{\david}[1]{{\color{green} \sf $\clubsuit\clubsuit\clubsuit$ David: [#1]}}

\def\edim{\operatorname{edim}}
\def\reg{\operatorname{reg}}

\newcommand{\ve}[1]{\ensuremath{\mathbf{#1}}}
\newcommand{\chr}{\ensuremath{\operatorname{char}}}

%Added by MB:
\def\nc{\newcommand}
\def\on{\operatorname}
\nc{\Q}{\mathbb{Q}}
\nc{\RR}{\mathbf{R}}
\nc{\LL}{\mathbf{L}}
\nc{\xra}{\xrightarrow}
\nc{\xla}{\xleftarrow}
\def\a{\alpha}
\def\om{\omega}
\def\Om{\Omega}
\def\DM{\operatorname{DM}}
\def\Coh{\operatorname{Coh}}
\def\Mod{\operatorname{Mod}}
\def\free{\operatorname{free}}
\def\QCoh{\operatorname{QCoh}}
\def\Cpx{\operatorname{Cpx}}
\def\th{\on{th}}
\def\F{\mathcal{F}}
\def\coker{\on{coker}}
\def\p{\partial}
\def\wt{\widetilde}
\def\om{\omega}
\def\l{\ell}
\def\i{\iota}
\nc{\into}{\hookrightarrow}
\nc{\onto}{\twoheadrightarrow}
\nc{\OO}{\mathcal{O}}
\nc{\Z}{\mathbb{Z}}
\nc{\cA}{\mathcal{A}}
\nc{\w}{\widehat}
\nc{\End}{\on{End}}
\nc{\res}{\frac{1}{x_0x_1}}
\nc{\tF}{\widetilde{F}}
\nc{\tG}{\widetilde{G}}
\nc{\tf}{\widetilde{f}}
\nc{\Com}{\on{Com}}


\nc{\G}{\mathbb{G}}
\nc{\cG}{\mathcal{G}}
\nc{\cE}{\mathcal E}
\nc{\cF}{\mathcal F}
\nc{\cR}{\mathcal R}
\nc{\cD}{\mathcal D}
\nc{\cB}{\mathcal B}
\nc{\cT}{\mathcal T}
\nc{\cL}{\mathcal L}
\def\M{\mathcal{M}}
\nc{\bM}{\mathbf M}
\nc{\bN}{\mathbf N}
\nc{\U}{\mathbf U}
\nc{\BM}{\mathbf B \mathbf M}
\nc{\Dsg}{\on{D}_{\on{sg}}}
\nc{\fC}{\mathcal{C}}
\nc{\fG}{\mathcal{G}}
\nc{\N}{\mathbb{N}}


%When merging files, add these
\nc{\del}{\partial}
\nc{\cone}{\on{cone}}
\nc{\D}{\on{D}_{\on{diff}}}
\nc{\DMb}{\on{D}^b_{\DM}}
\nc{\Db}{\on{D}^{\on{b}}}
\nc{\Kb}{\on{K}^{\on{b}}}
\nc{\fm}{\mathfrak{m}}
\nc{\Flag}{\on{Flag}}
\nc{\DMmin}{\DM_{\on{min}}}
\nc{\Ddiff}{\on{D}_{\on{diff}}}
\nc{\Dbdiff}{\on{D}^\on{b}_{\on{diff}}}
\nc{\wO}{\widehat{\OO}}
\nc{\wT}{\widehat{T}}
\nc{\from}{\leftarrow}
\nc{\wLL}{\widetilde{\LL}}
\nc{\augCech}{\widetilde{\cC}}
\nc{\Fold}{\on{Fold}}
\nc{\Ext}{\on{Ext}}
\nc{\FF}{\mathbf{F}}
\nc{\Comper}{\Com_{\on{per}}}
\nc{\Unfold}{\on{Unfold}}
\nc{\intHom}{\underline{\Hom}}
\nc{\Ex}{\on{Ex}}
\nc{\tg}{\widetilde{g}}
\def\tP{\widetilde{P}}
\def\b{\beta}
\nc{\B}{\mathcal{B}}
\nc{\K}{\mathcal{K}}
\nc{\kos}{\on{Kos}}
\nc{\Perf}{\on{Perf}}
\nc{\tR}{\widetilde{\cR}}
\nc{\X}{\mathcal{X}}
\nc{\Cl}{\on{Cl}}
\nc{\fU}{\mathcal{U}}

\title{Title}
\date{\today}



\begin{document}
\maketitle
\tableofcontents

%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
%%%%%%%%%%%%%%%%%%%%%%



\noindent{\bf Notational conventions:}

\begin{itemize}
\item We index homologically throughout. We say a complex $C$ is \emph{bounded above} (resp. \emph{bounded below}) if $C_i = 0$ for $i \gg 0$ (resp. $i \ll 0$).
\end{itemize}

%%%%%%%%%%%%%%%%%%%%
\section{Differential modules}
%%%%%%%%%%%%%%%%%%%%

Let $A$ be an abelian group, and let $R$ be an $A$-graded ring (for instance, $A$ could be 0). All modules over $R$ are right modules. \michael{We work with right modules because our main example will be $R = E$, and in Macaulay2, entries of matrices over $E$ act on the right. This is the same reason I'm working with homological indexing as opposed to cohomological: I'm trying to match M2.} 

\begin{defn}
Let $a \in A$. A \emph{degree $a$ differential $R$-module} is a pair $(D, \del_D)$, where $D$ is an $A$-graded module, and
$$
\del: D \to D(a)
$$
is an $R$-linear map such that $\del^2 = 0$. When the fixed element $a$ of $A$ is clear, we will just call $(D, \del_D)$ a \emph{differential module}. A morphism $(D, \del) \to (D', \del')$ of degree $a$ differential modules is a map $f : D \to D'$ satisfying $f \circ \del = \del' \circ f$. 
\end{defn}

For the rest of section, fix an element $a \in A$. Let $\DM(R,a)$ denote the category of degree $a$ differential $R$-modules. The \emph{homology} of an object $(D, \del) \in \DM(R,a)$ is the subquotient
$$
\ker(\del : D \to D(a) / \im(\del : D(-a) \to D),
$$
denoted $H(D, \del)$. A morphism in $\DM(R, a)$ is a \emph{quasi-isomorphism} if it induces an isomorphism on homology. A \emph{homotopy} of morphisms $f, f' : (D, \partial) \to (D', \partial')$ in $\DM(R, a)$ is a morphism $h : D\to D'(-a)$ of $A$-graded $R$-modules such that $f - f' = h \del + \del' h$. The \emph{mapping cone} of a morphism $f : (D, \partial') \to (D', \partial')$ in $\DM(R, a)$ is the object $(D \oplus D'(-a), \begin{pmatrix} -\del & 0 \\ f & \del' \end{pmatrix})$.

\iffalse
The following dictionary provides an easy shorthand for understanding our main results.

\begin{center}
\begin{tabular}{ | l | l | l | } 
 {\bf Complexes} & {\bf Differential modules}\\ 
  \hline
 Bounded above complex & Flag differential module \\ 
Perfect complex & Finite flag differential module \\ 
Projective resolution & Projective flag resolution \\
Minimal free resolution & Minimal free resolution\\
& (i.e. free, minimal and flag retract) \\
\end{tabular}
\end{center}
We will prove, for instance: a map of differential modules modules induces a map on
projective flag resolutions, which is unique up to homotopy; over a local or graded ring, every
finitely generated differential module admits a minimal free resolution, which is unique up
to isomorphism; and so on.
\fi


%%%%%%%%%%%%
\subsection{Expansion}
\label{expansion}
%%%%%%%%%%%%
Let $\Comper(R,a)$ denote the category of complexes of $A$-graded $R$-modules satisfying 
$$
D[j] = D(-ja)
$$
for all $j \in \Z$, with morphisms given by maps of complexes that are identical in each homological degree. \david{nonsense for $j=0$, assuming that morphisms are degree 0 homogeneous. What's really meant?} \michael{Fixed.}
There is an equivalence of categories
$$
\Ex: \DM(R,a) \xra{\simeq} \Comper(R,a)
$$
given by sending the differential module $(D, \del)$ to the complex
$$
\cdots \xra{\del} D(-a) \xra{\del} D \xra{\del} D(a) \xra{\del} \cdots.
$$
Following \cite[Section 1.4]{ABI}, we call $\Ex(D, \del)$ the \emph{expansion} of $(D, \del)$. The above notions of homology, quasi-isomorphism, homotopy, and mapping cone for differential modules all correspond to the usual notions via expansion.
\michael{I got rid of the signs in the differential of the expansion. I think it's better to follow ABI precisely here.}
%%%%%
\iffalse
\begin{rem}
\michael{Not sure this is useful.} Yet another way of thinking about the category $\Comper(R)$ is as follows. Consider the dga $A = R[t, t^{-1}]$ with trivial differential, where $t$ is a variable of internal degree $(0,1)$ and homological degree $-1$. The $\Comper(R)$ is identical to the category of dg-$A$-modules. 
\end{rem}
\fi
%%%%%%



%%%%%%%%%%%%%%%%%
\subsection{Projective flag resolutions}
%%%%%%%%%%%%%%%%%

We are interested in differential modules equipped with a filtration, in the following sense (cf. \cite[2.1]{ABI}). 

\begin{defn}[cf. \cite{ABI} Section 2.1]
A \emph{flag} is an object $(D, \del) \in \DM(R, a)$ equipped with a filtration $\cF_\bullet D$ such that 
\begin{itemize}
\item $\cF_i D \subseteq \cF_{i + 1} D$
\item $\del(\cF_i D) \subseteq \cF_{i - 1} D$, 
\item $\bigcup_i \cF_i D = D$, and
\item $\cF_{< 0} D = 0$.
\end{itemize}
We say a flag is \emph{locally finitely generated} if each component of the associated graded module is finitely generated. A \emph{split flag} is a differential module $(D, \del)$ equipped with a decomposition $D = \bigoplus_{j \in \Z} D_j$ such that the filtration $\cF_i D = \bigoplus_{j < i} D_j$ makes $(D, \del)$ a flag. A \emph{projective (resp. free) split flag} is a split flag such that each $D_j$ is projective (resp. free). 
\end{defn}

%%%
\iffalse
\begin{example}
Take $R = \ZZ[x]/(x^2)$. 
The complex
$$
0 \to R \xra{x} R(1) \xra{x} \cdots
$$
thought of as a differential module, does not admit a flag. The object $(\ZZ[x]/(x^2), x) \in \DM(R, a)$ admits a flag, but not a split flag.
\end{example}
\fi
%%%

\begin{rem}
A split flag $(D, \del)$ such that $\del(D_i) \subseteq D_{i - 1}$ is the same thing as a 
chain complex of $R$-modules that is concentrated in nonnegative degrees.  
\david{maybe $\del(D_i) \subseteq D_{i - 1}$}\michael{Fixed.}
\end{rem}

\begin{defn}
Let $(D, \del_D) \in \DM(R, a)$, and let $(P, \del_P) \in \DM(R, a)$ be a projective (resp. free) split flag. A quasi-isomorphism $\epsilon: (P, \del_P) \to (D, \del_D)$ is called a \emph{projective flag resolution} (resp. \emph{free flag resolution}). A projective (resp. free) flag resolution is called \emph{locally finitely generated} if the flag $P$ is such. 
\end{defn}

\begin{prop}
\label{resexists}
Every $(D, \del) \in \DM(R, a)$ admits a free flag resolution. If $H(D, \del)$ is finitely generated, then $(D, \del)$ admits a locally finitely generated free flag resolution.
\end{prop}

\begin{proof}


We give two proofs, each of which highlights a different aspect.

{\em Killing cycles approach:} 
Choose a set of cycles in $D$ that descends to a generating set of $H(D)$, and let $F_0$ be a free $R$-module with basis indexed by this set. Let $\epsilon_0 : (F_0, 0) \to (D, \del_D)$ be the morphism of differential modules that sends each basis element to its associated cycle. Next, choose a set of cycles in $\on{cone}(\epsilon_0)$ that descends to a generating set of $H(\on{cone}(\epsilon_0))$, let $F_1$ be a free $R$-module with basis indexed by this set, and define $\epsilon_1 : (F_1, 0) \to \cone(\epsilon_0)$ as before. Iterating this process, we obtain a flag $(F = \bigoplus_{i \ge 0} F_i, \del_F)$ 
and a quasi-isomorphism $\epsilon : (F, \del_F) \xra{\simeq} (D, \del_D)$. Finally, if $H(D, \del)$ is finitely generated, then we can choose finite generating sets in every step of this process, yielding a locally finitely generated free flag resolution. 

{\em Cartan-Eilenberg approach:} Let $B,Z\subseteq D$ denote the boundaries and cycles of $(D,\partial)$.  Then, in the cateogry of differential modules, we have a short exact sequence:
\[
0\to (Z,0) \to (D,\partial) \to (B(a),0)\to 0.
\]
Note that the differentials on $Z$ and $B$ are $0$.  Any free resolution $F^Z\to Z$ in the category of modules will also be a free resolution of $(Z,0)$ in the category of differential modules, and similarly for $F^B\to B(a)$.   The extension above induces a map of complexes $\epsilon: F^B[1]\to F^Z$ (a priori it is only a map in the derived category, but since $F^B$ is free, this is a genuine morphism of complexes). We let $(F^D,d)$ be the mapping cone of $\epsilon$ in the category of differential modules.  Then $(F^D,d)$ is quasi-isomorphic to $(D,\partial)$.  Moreover, we can give $(F^D,d)$ a split flag structure by $F^D_i = F^B_i\oplus F^Z_i$.  Thus $(F^D,d)$ is a free flag resolution of $(D,\del)$.
\end{proof}
%\michael{I don't think the Cartan-Eilenberg resolution yields a flag, so the killing cycles algorithm seems to be our only method for building free flag resolutions.}


As in classical homological algebra, morphisms of differential modules may be lifted to projective flag resolutions in a unique way, up to homotopy.  More generally, we have the following

\begin{prop}\label{prop:lifting}
Let $(D, \partial_D), (D', \partial_{D'}) \in \DM(R, a)$, and suppose we have morphisms $\epsilon : (P, \partial_P) \to (D, \partial_D)$, $\epsilon' : (P', \partial_{P'}) \to (D', \partial_{D'})$, where $(P, \partial_P)$ is a projective split flag, and $\epsilon'$ is a quasi-isomorphism. Given a morphism $f: (D, \partial_D) \to (D', \partial_{D'})$ of differential modules, there exists a morphism
$$
\tf:  \on{cone}(\epsilon) \to \on{cone}(\epsilon')
$$ 
of differential modules of the form 
\begin{equation}
\label{matrix}
\begin{pmatrix}
\alpha & 0  \\
\rho & f
\end{pmatrix}.
\end{equation}
In particular, the entry $\a: P \to P'$ of (\ref{matrix}) is a morphism of differential modules. Moreover, given two such lifts
$$
\tf_1 = \begin{pmatrix}
\alpha_1 & 0  \\
\rho_1 & f
\end{pmatrix}, 
\tf_2 = \begin{pmatrix}
\alpha_2 & 0  \\
\rho_2 & f
\end{pmatrix}
: \cone(\epsilon) \to \cone(\epsilon'),
$$
there is a homotopy 
$$
h = \begin{pmatrix} h_1 &0 \\ h_2 & 0 \end{pmatrix} : P \oplus D \to P'(-a) \oplus D'(-a).
$$
between $\tf_1$ and $\tf_2$. In particular, $h_1$ is a homotopy between $\a_2$ and $\a_1$.
\end{prop}

\begin{rem}
It need not be the case that $\epsilon' \a = f \epsilon$. For instance, \michael{Fill in.}
\end{rem}


\begin{proof}
Set $\tP := \cone(\epsilon)$ and $\tP':= \cone(\epsilon')$. We begin by defining $g_0 : P_0 \to \tP'$ such that the map
$$
\tf_0 : P_0 \oplus D \to \tP'
$$
given by $(p, d) \mapsto g_0(p) + (0, f(d))$ is a morphism of differential modules, where $P_0 \oplus D$ is equipped with the differential $\begin{pmatrix} 0 & 0 \\ \epsilon & \del_D \end{pmatrix}$, i.e. the restriction of $\del_{\tP}$ to $P_0 \oplus D$. We have a diagram 
$$
\xymatrix{
& \tP' \ar[d]^-{\del_{\tP'}} \\
P_0 \ar[r]^-{\beta} & \im(\del_{\tP'}) = \ker(\del_{\tP'}),
}
$$
where $\beta(p) = (0, (f  \epsilon)(p))$. Note that $\beta$ does indeed land in $\ker(\del_{\tP'})$: we have
$$
(\del_{\tP'}  \beta)(p) = (0, (\del_{D'}  f  \epsilon)(p)) = (0, (f  \del_{D}  \epsilon)(p)) = 0;
$$
the last equality holds since $\partial_{P}|_{P_0} = 0$, and $\epsilon \partial_P = \partial_D \epsilon$. Since $P_0$ is projective, we get an induced map
$$
g_0 : P_0 \to \tP'
$$
making the diagram commute. One easily checks that $g_0$ has the desired property: if $(p,d) \in P_0 \oplus D$,
\begin{align*}
(\tf_0  \del_{\tP})(p, d) & = (0, (f  \epsilon)(p) )+ (0, (f  \del_D)(d)) \\
&=  \beta(p) +(0,  (\del_{D'}  f)(d)) \\
&= (\del_{\tP'}  g_0)(p) + \del_{\tP'}(0, f(d)) \\
&= (\del_{\tP'}  \tf_0)(p, d).
\end{align*}

Now, suppose $n > 0$, and assume we have 
$$
g_{i} : P_{\le i}  \to \tP'
$$
for all $i < n$, such that 
\begin{itemize}
\item the map $\tf_{i} : P_{\le i} \oplus D \to \tP'$ given by $(p, d) \mapsto g_{i}(p) + (0, f(d))$ is a morphism of differential modules (where $P_{\le i} \oplus D$ is equipped with the differential given by the restriction of $\del_{\tP}$), and
\item $g_{i}|_{P_{\le j}} = g_{j }$ for all $j < i$.
\end{itemize}
We have a diagram
$$
\xymatrix{
& \tP' \ar[d]^-{\del_{\tP'}} \\
P_{n} \ar[r]^-{\gamma} & \im(\del_{\tP'}) = \ker(\del_{\tP'}),
}
$$
where $\gamma(p) = (\tf_{n-1}  \del_{\tP})(p, 0)$; the map $\gamma$ lands in $\ker(\del_{\tP'})$, since 
$$
(\del_{\tP'}  \tf_{n-1}  \del_{\tP})(p,0) = (\tf_{n-1}   \del_{\tP}  \del_{\tP})(p, 0) = 0. 
$$
Since $P_{n}$ is projective, we obtain a map $\widetilde{\gamma} : P_{n} \to \tP'$ making the diagram commute. We define $g_{n} : P_{\le n} \to \tP'$ to be the map
$$
\begin{pmatrix} g_{n-1} & \widetilde{\gamma} \end{pmatrix} : P_{\le n-1} \oplus P_n \to \tP'.
$$
We now verify that the map 
$$
\tf_{n} : P_{\le n} \oplus D \to \tP',
$$
given by $(p, d) \mapsto g_{n}(p) + (0, f(d))$, is a morphism of differential modules. Let $(p, d) \in P_{\le n} \oplus D$. We have:
\begin{align*}
(\tf_{n}  \del_{\tP})(p, d) &= g_{n}(-\del_P(p)) + (0, (f  \epsilon)(p) + (f  \del_D)(d)) \\
& = \tf_{n}( -\del_P(p), \epsilon(p)) + (0, (\del_{D'} f)(d)) \\
&= (\tf_{n}  \del_{\tP})(p, 0) + (\del_{\tP'} \tf_n)(0,d),
\end{align*}
so it suffices to show
$$
(\tf_{n}  \del_{\tP})(p, 0)  = (\del_{\tP'}  \tf_{n})(p, 0).
$$
To see this, write $p = p' + p''$, where $p' \in P_{\le n -1}$ and $p'' \in P_n$, and notice that
\begin{align*}
(\tf_{n}  \del_{\tP})(p, 0) &= (\tf_{n-1}  \del_{\tP})(p, 0) \\
&= (\tf_{n-1}  \del_{\tP})(p', 0) + (\tf_{n-1}  \del_{\tP})(p'', 0) \\
&= ( \del_{\tP'}\tf_{n-1})(p', 0) + \gamma(p'') \\
&= (\del_{\tP'} \tf_{n} )(p', 0) + (\del_{\tP'} g_n)(p'') \\
&= (\del_{\tP'} \tf_{n} )(p', 0) + (\del_{\tP'} \tf_{n})(p'',0) \\
&= (\del_{\tP'} \tf_{n})(p, 0). \\
\end{align*}

Let $g$ be the colimit of the $g_i$, and take $\tf : \tP \to \tP'$ to be given by $(p, d) \mapsto g(p) + (0, f(d))$. We now show our lift $\tf$ is unique up to homotopy. Without loss, assume $f = 0$; we will show $\tf$ is null homotopic. We again proceed by induction. We have a diagram
$$
\xymatrix{
& \tP' \ar[d]^-{\del_{\tP'}} \\
P_0 \ar[r]^-{g_0} & \ker(\del_{\tP'}),
}
$$
since $(\del_{\tP'}  g_0)(p) = \beta(p)=0 $ for all $p \in P_0$. Since $P_0$ is projective, we obtain a map $s_0 : P_0 \to \tP'$ making the diagram commute. Let $n > 0$, and suppose we have maps $s_i : P_{\le i} \to \tP'$ for $i < n$ such that
\begin{itemize}
\item $g_i =  \del_{\tP'}   s_i - s_{i - 1}  \del_{P} $ (set $s_{<0} := 0$), and 
\item $s_{i}|_{P_{\le j}} = s_{j }$ for all $j < i$. 
\end{itemize}
In particular, let's record the relation
\begin{equation}
\label{relation}
g_{n-1} = \del_{\tP'}   s_{n-1} - s_{n-2}  \del_{P} .
\end{equation}
We have a diagram
$$
\xymatrix{
&&& \tP' \ar[d]^-{\del_{\tP'}} \\
P_{\le n} \ar[rrr]^-{g_{n} + s_{n-1}  \partial_{P}} &&& \ker(\del_{\tP'}),
}
$$
since, by (\ref{relation}), we have
\begin{align*}
\del_{\tP'}  (g_n + s_{n-1}  \partial_{P}) &= \del_{\tP'}  g_{n} + ( g_{n-1} + s_{n-2}  \del_P ) \del_P \\
&= \del_{\tP'}  g_{n}  +  g_{n-1}  \del_P,
\end{align*}
and
\begin{align*}
(\del_{\tP'}  g_{n} )(p) &= (\del_{\tP'}  \tf_{n})(p, 0)\\
& = (\tf_{n}  \del_{\tP})(p, 0) \\
&= \tf_{n}(-\del_P(p), \epsilon(p)) \\
&= -(g_{n-1}  \del_P)(p).
\end{align*}
Define $s_{n} : P_{\le n} \to \tP'$ making the diagram commute. Let $s$ denote the colimit of the $s_i$. We have 
$$
g=  \del_{\tP'}  s - s   \del_P.
$$
Now take $h : \tP \to \tP'$ to be the map given by $(p, d) \mapsto s(p)$, and observe that
\begin{align*}
\tf(p, d) & = g(p) \\
&= (\del_{\tP'}  s)(p)  - (s  \del_P)(p) \\
& = (\del_{\tP'}  h)(p, d) + (h  \del_{\tP})(p, d). \\
\end{align*}
\end{proof}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{$\otimes$ and $\underline{\Hom}$ for (some) differential modules}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
As stated in \cite{ABI}, there is no tensor product for differential modules in general. However, suppose $A$ is of the form $B \times \Z$ for some abelian group $B$, and let $a \in A$ be of the form $(b, \pm 1)$ for some $b \in B$. We can use the $\Z$-grading to define notions of tensor product and internal $\Hom$ for degree $a$ differential $R$-modules in the following way. First, if $N$ is an $A$-graded $R$-module, and $n \in N$ is homogeneous with respect to the $\Z$-grading, define $||n|| \in \Z$ to be the $\Z$-degree of $n$. Let $(D, \del_D), (D', \del_{D'}) \in \DM(R, a)$, and assume $D$ and $D'$ are equipped with left $R$-actions making them $R$-$R$-bimodules. Define
$$
D \otimes_R^{\DM} D' = (D \otimes_R D', d \otimes d' \mapsto \del_D(d) \otimes d' + (-1)^{||d||}d \otimes \del_{D'}(d')) \in \DM(R, a)
$$
and 
$$
\underline{\Hom}_R^{\DM}(D, D') = (\underline{\Hom}_R(D, D'), f \mapsto f \circ \del_D - (-1)^{||f||} \del_{D'} \circ f) \in \DM(R, a).
$$

Let $(D, \del_D) \in \DM(R,a)$. It's clear that there is an adjunction
$$
- \otimes_R^{\DM} D : \DM(R,a) \leftrightarrows \DM(R,a) : \underline{\Hom}_R^{\DM}(D, -).
$$

\begin{rem}
The ring $R$, thought of as a $B$-graded ring, may be considered as a dg-algebra (over $\Z$) with trivial differential and homological grading induced by the $\Z$-grading. When $a = (0, -1)$, the category $\DM(R, a)$ is equivalent (in fact, isomorphic) to the category of dg-modules over this dg-algebra, and the notions of tensor product and internal Hom described above correspond to the usual ones for dg-modules.
\end{rem}

Let $F$ be a free flag resolution of $D$, and let $(D', \del_{D'})$ be another object in $\DM(R, a)$. We define
$$
\Tor^R_{\DM}(D, D') = H(F \otimes^{\DM}_R D')
$$
and
$$
\Ext_R^{\DM}(D, D') = H(\underline{\Hom}^{\DM}_R(F, D')).
$$
It follows easily from Proposition \ref{prop:lifting} that these definitions do not depend on the choice of free flag resolution. 



\begin{rem}
Suppose $A$ is an arbitrary grading group, $a \in A$, and $(D, \del_D), (D', \del_{D'}) \in \DM(R, a)$, where $D, D'$ are $R$-$R$-bimodules. When $\del_{D'} = 0$, the definitions of $D \otimes^{\DM}_R D'$, $\underline{\Hom}_R^{\DM}( D , D')$, $\Tor^R_{\DM}(D, D')$, and $\Ext_R^{\DM}(D, D')$ still make sense.
\end{rem}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Positive gradings}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
We will need a generalization of the usual $\Z$-graded version of Nakayama's Lemma that allows for gradings by finitely generated free abelian groups. Before we state it, we formulate notions of ``positively graded" rings and modules in this setting, closely following \cite[Chapter 8]{MS}.

\begin{prop}
\label{gradingprop}
Suppose $A = \Z^{\oplus r}$ for some $r$, and assume the monoid
$$
A_R = \{ a \in A \text{ : } R_a \ne 0\}
$$
is \emph{pointed}, i.e. the only element $a \in A_R$ such that $-a \in A_R$ is 0. There is a morphism $\theta_R: A_R \to \Z$ of monoids such that $\theta_R(a) \ge 0$ for all $a \in A_R$ and $\theta_R(a) = 0$ if and only if $a = 0$. 
\end{prop}

\begin{proof}
By \cite[Corollary 7.23]{MS}, there is an embedding $\psi: A_R \into \N^{\oplus r}$ of monoids. Take $\theta_R$ to be the composition of $\psi$ with the map $\N^{\oplus r} \to \Z$ given by $(m_1, \dots, m_r) \mapsto \sum_{i = 1}^r m_i$.
\end{proof}

\begin{defn}
We say $R$ is \emph{positively $A$-graded} if $R$ satisfies the hypotheses of Proposition \ref{gradingprop}, and $R$ is equipped with a morphism $\theta_R : A_R \to \Z$ of monoids as in the conclusion of Proposition \ref{gradingprop}.
\end{defn}
If $M$ is an $A$-graded $R$-module, we denote by $A_M$ the semigroup $\{a \in A \text{ : } M_a \ne 0\}.$
\begin{defn}
Suppose $R$ is positively $A$-graded and $M$ is a nonzero $A$-graded $R$-module. We say $M$ is \emph{positively $A$-graded} if there is a morphism $\theta_M : A_M \to \Z$ of semigroups such that
\begin{itemize}
\item the image of $\theta_M$ is bounded below, and
\item if $a \in A_R$, $b \in A_M$, and $a + b \in A_M$, then $\theta_M(a + b) =\theta_M(m) +  \theta_R(r)$.
\end{itemize}
\end{defn}



\begin{rem}
\label{sub}
Suppose $R$ is positively $A$-graded. Any submodule or quotient module of a positively $A$-graded module is clearly positively $A$-graded. 
\end{rem}

Let $R_+ = \bigoplus_{a \ne 0} R_a$. Note that, if $R$ is positively graded, $R_+$ is an ideal. 

\begin{lemma}[Nakayama's Lemma]
\label{nak}
Assume $R$ is positively graded, and let $M$ be a positively graded $R$-module. If $R_+ M = M$, then $M = 0$.
\end{lemma}

\begin{proof}
Suppose $M \ne 0$. Choose $a \in A_M$ such that $\theta_M(a)$ is as small as possible, and choose some nonzero $m \in M$ such that $|m| = a$. Choose $r \in R_+$ and $m' \in M$ such that $m'r = m$. Say $m' = m'_1 + \cdots + m'_s$ and $r = r_1 + \cdots + r_t$, where each $m'_i$ and $r_j$ is nonzero and homogeneous. Choose $i$ and $j$ such that $m'_i r_j \ne 0$. Then $|m'_ir_j| = a$, so $\theta(|m'|) = \theta(a) - \theta(|r'|) < \theta(a)$, a contradiction.
\end{proof}

\begin{remark}
The assumptions on $R$ in Nakayama's Lemma can be weakened: all that is needed is a morphism $\theta_R: A_R \to \Z$ of monoids such that $\theta_R(a) \ge 0$ for all $a \in A_R$ and $\theta_R(a) = 0$ if and only if $a = 0$
\end{remark}

\begin{prop}
\label{modules}
Assume $R$ is positively graded. If $M$ is a finitely generated module, then
\begin{enumerate}
\item $M$ is positively graded; and 
\item when $R$ is a finite type $R_0$-algebra, $M_a$ is a finitely generated $R_0$-module for all $a \in A$.
\end{enumerate}
\end{prop}

\begin{proof}
For any $b \in A$, notice that $A_{R(b)} = \{a - b \text{ : } a \in A_R\}$. We equip $R(b)$ with a positive grading via the map of monoids $\theta_{R(b)} : A_{R(b)} \to \Z$ given by $a - b \mapsto \theta_R(a) - \sum_{i = 1}^r b_i$. For any $A$-graded free $R$-module $F$, we can use this formula to define a map $\theta_F : A_F \to \Z$ of monoids such that $\theta_F(mr) =\theta_F(m) +  \theta_R(r)$. The map $\theta_F$ gives $F$ a positive grading whenever its image is bounded below, which is the case when $F$ is finitely generated. Finally, by Remark \ref{sub}, any quotient of a positively graded $A$-module is again positively graded; this proves (1). 

As for (2), suppose $R$ is generated as an $R_0$-algebra by $y_1, \dots, y_m$. We may assume without loss that the $y_i$ are homogeneous of nonzero degree. Let $m_1, \dots, m_r$ be homogeneous generators of $M$, and let $a \in A$. It is clear that $M_a$ is generated over $R_0$ by the set
$$
\{f_im_i \text{ : } 1 \le i \le m \text{, } \text{$f_i$ a monomial in the variables $y_1, \dots, y_m$ of degree $a - |m_i| 
$}\}
$$
Since $R$ is positively graded, this generating set is finite.
\end{proof}

\begin{rem}
Part (1) of Proposition \ref{modules} also holds when $M$ is a locally finitely generated free flag resolution of a differential $R$-module, by the same proof. 
\end{rem}







%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Minimal free resolutions}
\label{minsection}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


From now on, assume either
\begin{itemize}
\item[(1)] the grading group $A$ is trivial and $R$ is local, or
\item[(2)] $R$ is positively graded, $R_0$ is a field, and $R$ is a quotient of a polynomial or exterior algebra over $R_0$. \michael{maybe $R_0$ can just be local. Also maybe remove the quotient of a polynomial of exterior algebra part and only add it to the results that really need it.}
\end{itemize}
Let $\m$ denote either the unique maximal ideal of $R$ in the first case or $R_+$ in the second case. In either case, we let $k = R/\m$. We say a morphism $f : M \to N$ of $A$-graded $R$-modules is \emph{minimal} if $f(M) \subseteq \m N$.

We now wish to define a notion of minimal free resolutions for differential $R$-modules. It is tempting to define such a resolution to be a minimal free flag resolution. But, we will see in Example \ref{DNE} that such resolutions do not exist in general. Instead, we proceed as follows. 

\begin{defn}
A \emph{trivial} differential $R$-module is a direct sum of objects in $\DM(R, a)$ of the form
$$
R(b) \oplus R(b-a) \xra{\begin{pmatrix} 0 & 0 \\ 1 & 0 \end{pmatrix}} R(b+a) \oplus R(b)
$$
for some $b \in A $.
\end{defn}

\begin{rem}
A free differential module $(F, \del_F)$ is isomorphic to a trivial differential module if and only if it is \emph{contractible}, i.e. the identity map on $F$ is null-homotopic. 
\end{rem}
\michael{Double check this remark.}


\begin{prop}
\label{decomp}
Let $(F, \partial_F)$ be either a finitely generated free differential module or a locally finitely generated free split flag. There is an automorphism $A$ of $F$ such that
$$
(F, A\partial_FA^{-1}) =  (T, \partial_T) \oplus (M, \partial_M),
$$
where $(T, \partial_T)$ is trivial and $(M, \partial_M)$ is minimal.
\end{prop}

\begin{proof}
Suppose first that $F$ is finitely generated. Choose a basis of $F$, and view $\partial_F$ as a matrix with respect to this basis. If $\del_F$ has no unit entries, then it is minimal and we are done.  Otherwise, the condition $\partial_F^2 =0$ forces $\del_F$ to have a unit entry $u$ that does not lie on the diagonal. Without loss of generality, we can assume that this entry is in the first column and second row.  
%%%%%%%%
\iffalse
After acting by the diagonal matrix with entries $(1,u^{-1},1,1,\dots)$ we can assume that $u=1$. \michael{I think this isn't allowed. We can't turn $u$ into 1 by conjugating. So our definition of a trivial DM should involve any unit, not just 1.} So we have:
\[
\partial_F = \begin{pmatrix}
a_{1,1}&a_{1,2}&a_{1,3}&\cdots \\
1&a_{2,2}&a_{2,3}&\cdots \\
a_{3,1}&a_{3,2}&a_{3,3}&\cdots\\
a_{4,1}&a_{4,2}&a_{4,3}&\cdots\\
\vdots&\vdots&\vdots&\ddots
\end{pmatrix}
\]
\fi
%%%%%%%
Let $B_1$ be the matrix corresponding to the row operations that zero out all other entries in the first column of $\partial_F$.  This is an identity matrix, except in the second column.  It follows that $B_1\partial_FB_1^{-1}$ has the form:
\[
B_1\partial_F B_1^{-1}
=
\begin{pmatrix}
0&a'_{1,2}&a'_{1,3}&\cdots \\
u&a_{2,2}&a_{2,3}&\cdots \\
0&a'_{3,2}&a'_{3,3}&\cdots\\
0&a'_{4,2}&a'_{4,3}&\cdots\\
\vdots&\vdots&\vdots&\ddots
\end{pmatrix}.
\]
Let $B_2$ the matrix corresponding the column operations which zero out all the other entries in the second row of $\partial_F$.  This is an identity matrix, except in the top row.  It follows that $B_2^{-1}B_1\partial_F B_1^{-1}B_2$ has the form
\[
B_2^{-1}B_1\partial_F B_1^{-1}B_2
=
\begin{pmatrix}
0&a''_{1,2}&a''_{1,3}&\cdots \\
u&0&0&\cdots \\
0&a''_{3,2}&a''_{3,3}&\cdots\\
0&a''_{4,2}&a''_{4,3}&\cdots\\
\vdots&\vdots&\vdots&\ddots
\end{pmatrix}.
\]
The first column of $\partial_F^2$ equals the second column of $\partial_F$ multiplied by $u$. Since $\partial_F^2=0$, this means that the entire second column is zero.  Similarly, the second row of $\partial_F^2$ is the first row of $\partial_F$ multiplied by $u$, and thus the entire first row of $\partial_F$ must be zero. We conclude that
$$
(F, B_2^{-1}B_1\partial_F B_1^{-1}B_2) = (T, \del_T) \oplus (D, \del_D),
$$
where $T$ is a rank 2 free $R$-module, and $\del_T = \begin{pmatrix} 0&0\\u&0 \end{pmatrix}.$ Without loss, we can assume $u = 1$. Now apply the same argument to $(D, \del_D)$. Since $F$ is finitely generated, this process eventually terminates.  

Suppose now that $F$ is a locally finitely generated free split flag. We can apply the above argument to each summand $F_i$, yielding automorphisms $A_i$ such that $(F_i, A_i \del_F A_i^{-1}) = (M_i, \del_{M_i}) \oplus (T_i, \del_{T_i})$ for all $i$. Moreover, the above argument shows that we can choose the trivial summands to be compatible for increasing $i$: that is, we may assume that there are inclusions $T_i \to T_{i+1}$ for all $i$, such that
\[
\xymatrix{
T_i \ar[r]\ar[d]&F_i\ar[d]\\
T_{i+1}\ar[r]&F_{i+1}
}
\]
commutes for all $i$. 
\iffalse
It follows that the diagram
\[
\xymatrix{
T_i \ar[d]&\ar[l]F_i\ar[d]\\
T_{i+1}&\ar[l]F_{i+1},
}
\]
where the horizontal maps are the projections, also commutes. 
\fi
These diagrams induce maps $M_{i}\to M_{i+1}$, which may not be inclusions.  We let $(M,\partial_M)$ be the colimit of the $(M_i,\partial_{M_i})$, and similarly for $(T,\partial_T)$.  Since colimits commute with coproducts, $F=T \oplus M$.  It is clear from the construction that $T$ is trivial. Since each $\partial_{M_i}$ factors through $\mathfrak mM_i$, $\on{colim} \partial_{M_i}$ factors through $\mathfrak m \on{colim} M_i=\mathfrak m M$.  
\end{proof}


\begin{defn}
Let $(D, \del_D) \in \DM(R, a)$. A \emph{stably free flag resolution} of $(D, \del_D)$ is a free differential module $(G, \del_G)$ such that there is a free flag resolution
$$
(F, \del_F) \xra{\epsilon} (D,\del_D)
$$
and a trivial differential module $(T, \del_T)$ satisfying $(F, \del_F) = (G, \del_G) \oplus (T, \del_T)$. We say $(G, \del_F)$ is a \emph{minimal stably free flag resolution} if $\del_G$ is minimal. We will shorten ``minimal stably free flag resolution" to ``minimal free resolution" from now on.
\daniel{Should we call this a ``flag retract'' or something?}\michael{I think not, because retract just means summand of a flag, but we want a summand of a flag *whose complement is trivial*. So I think ``stable" really is the right term here.}
\daniel{At least let's add a remark comparing this with retract.}
\end{defn}





\begin{prop}
\label{minresexists}
Let $(D, \del_D) \in \DM(R, a)$. If $(D, \del_D)$ admits a locally finitely generated free flag resolution, then $(D, \del_D)$ admits a minimal free resolution.
\end{prop}
\begin{proof}
Combine Propositions \ref{resexists} and \ref{decomp}.
\end{proof}

To prove uniqueness of minimal free resolutions, we will need the following results.



\begin{lemma}
Assume $R$ is positively graded, and $R_0$ is a field (or maybe just local), and $R$ is a quotient of a polynomial or exterior algebra over $R_0$. Let $(D, \del_D) \in \DM(R, a)$.
\begin{itemize}
\item[(a)] Let $(F, \del_F) \xra{\simeq} (D, \del_D)$ be a locally finitely generated free flag resolution.  If $\dim_k (F \otimes_R k)_a < \infty$ for all $a \in A$, then $\dim_k F_a < \infty$ for all $a \in A$.
\item[(b)] Suppose $H(D, \del_D)$ is finitely generated. Let $(F, \del_F) \xra{\simeq} (D, \del_D)$ be a minimal free resolution that arises as a summand of a locally finitely generated free flag resolution. If $R$ satisfies Assumption (2) at the beginning of Subsection \ref{minsection}, then $\dim_k F_a < \infty$ for all $a \in A$. 
\end{itemize}  
\end{lemma}

\begin{proof}
By Proposition \ref{modules}, we need only show that each $F_a$ is contained in only finitely many summands of the flag $F$. \michael{finish this.} To prove (b), note that there is a convergent spectral sequence
$$
E^2_{pq} = \on{Tor}_p^R(H_{q}(\on{Ex}(D), k)) \Rightarrow \on{Tor}^R_{p + q}(\Ex(D), k),
$$
and so 
$$
\dim_k (F \otimes^{\DM}_R k)_a = \dim_k \on{Tor}^R_{\DM}(D, k)_a < \infty
$$
for all $a \in A$. Now apply (a).
\end{proof}


\begin{lemma}
\label{factors}
Let $(M, \del_M), (M', \del_{M'})$ be minimal differential modules. If a morphism
$$
f : (M, \del_M) \to (M', \del_{M'})
$$
factors through a trivial differential module, $f$ is minimal. 
\end{lemma}

\begin{proof}
Suppose we have a factorization
$$
(M, \del_M)  \xra{g} (T, \del_T) \xra{h} (M', \del_{M'})
$$
of $f$, where $(T, \del_T)$ is trivial. Let $m \in M$, and choose a basis $\{e_i\}_{i \in I}$ of $T$. We can write $g(m)$ as
$$
r_1 e_{i_1} + \cdots + r_n e_{i_n}.
$$
Suppose $r_j \notin \m$. Since $ r_1 \del_T(e_{i_1}) + \cdots + r_n \del_T(e_{i_n}) =  \del_T(g(m)) = g(\del_M(m))  \in \m T$, and $\del_T$ is a matrix with at most a single 1 in each row and 0's elsewhere, we have $\del_T(e_{i_j}) = 0$. Using that $T$ is exact, choose an element $t \in T$ such that $e_{i_j} = \del_T(t)$. Then
$$
h(e_{i_j}) = h(\del_T(t)) = \del_{M'}(h(t)) \in \m M'.
$$
We conclude that $f(m) \in \m M'$.
\end{proof}





\begin{thm}
\label{uniqueness}
Let $(D, \del_D) \in \DM(R, a)$, and suppose $H(D, \del_D)$ is finitely generated. Let
$$
\xymatrix{
(M, \del_M) \oplus (T, \del_T) \ar[rd]^-{\epsilon}& &  (M', \del_{M'}) \oplus (T', \del_{T'}) \ar[ld]_-{\epsilon'}\\
&(D, \del_D)&
}
$$
be locally finite free flag resolutions, where $(M, \del_M)$, $(M', \del_{M'})$ are minimal and $(T, \del_T), (T', \del_{T'})$ are trivial. There is an isomorphism $(M, \del_M) \cong (M', \del_{M'})$. In particular, minimal free resolutions of differential modules with finitely generated homology are unique up to isomorphism.
\end{thm}

\begin{proof} 
Applying Proposition~\ref{prop:lifting} to the identity map on $D$, we may choose morphisms
\begin{align*}
\a = \begin{pmatrix} \a_1 & \a_2 \\ \a_3 & \a_4 \end{pmatrix}   :  (M, \del_M) \oplus (T, \del_T) \to (M', \del_{M'}) \oplus (T', \del_{T'}) \\
\a' = \begin{pmatrix} \a'_1 & \a'_2 \\ \a'_3 & \a'_4 \end{pmatrix} :  (M', \del_{M'}) \oplus (T', \del_{T'}) \to (M, \del_M) \oplus (T, \del_T) 
\end{align*}
of differential modules and homotopies
\begin{align*}
h & = \begin{pmatrix} s_1 & s_2 \\ s_3 & s_4 \end{pmatrix} : M \oplus T \to M(0, -1) \oplus T(0, -1) \\
h' & = \begin{pmatrix} s_1' & s_2' \\ s_3' & s_4' \end{pmatrix} : M' \oplus T' \to M'(0, -1) \oplus T'(0, -1)
\end{align*}
such that
\begin{align*}
\a'\a - \id_{F} &= h \del_{M \oplus T} + \del_{M \oplus T} h \\
\a\a' - \id_{F'} &= h' \del_{M' \oplus T'} + \del_{M' \oplus T'}h'
\end{align*}
Reading off the top-left entry of the matrices on each side of these equations, we get
\begin{align*}
\a_1'\a_1 + \a_2'\a_3  - \id_F&=  h_1 \del_M + \del_M h_1 \\
\a_1\a_1' + \a_2\a_3'  - \id_{F'} &=  h_1' \del_{M'} + \del_{M'} h_1'.
\end{align*}
By Lemma \ref{factors}, $\a_2'\a_3$ and $\a_2\a_3'$ are minimal. We conclude that $\a_1'\a_1 = \id_M$ and $\a_1\a_1' = \id_{M'}$ modulo $\m$. 

Now, assume $R$ satisfies Assumption (2) at the beginning of Subsection \ref{minsection}. By Example \ref{posgradingex}, $M$ and $M'$ are positively graded. By Lemma \ref{nak} and Proposition \ref{minresexists}, it follows that $\a_1'\a_1$ and $\a_1\a_1'$ are automorphisms. In particular, $\a_1$ is injective and surjective. In the case where $R$ is trivially graded... \michael{Not sure how this is going to work in non-graded case. May just need to assume $M$ and $M'$ are finitely generated in this case.}
\end{proof}

\begin{example}
\label{DNE}
We now give an example of a differential module with no minimal free flag resolution. Take $A = \Z$, $a = 2$, and $R = k[x, y]$, where $|x| = 1 = |y|$. Let $D = R^{\oplus 2}$, and take
$$
\del_D : R^{\oplus 2} \to R(2)^{\oplus 2}
$$
to be
$$
\begin{pmatrix}
xy & -x^2 \\
y^2 & -xy\\
\end{pmatrix}.
$$
Since $(D, \del_D)$ does not admit a flag structure (\cite{ABI}), it suffices, by Theorem \ref{uniqueness}, to show that $(D, \del_D)$ is the minimal free resolution of itself. 

We use the Cartan-Eilenberg construction to produce a free flag resolution of $(D,\del_D)$.  The cycles are the rank $1$ free submodule of $R^2$ generated by $\begin{pmatrix} x \\ y \end{pmatrix}$, so $Z$ is resolved by $G: = [R(-1)]$.  The boundaries $B$ are the image of the above matrix, and so $B(-2)$ is resolved by $H:=[R(-2)^2 \gets R(-3)]$.  Using this, we can produce a Cartan-Eilenberg resolution
 of $(D, \del_D)$ given by
$$
F = G_0\oplus H_0 \oplus H_1(2) = R(-1) \oplus R(-2) \oplus R(-2) \oplus R(-1),
$$
$$
\del_F = \begin{pmatrix} 0 & -y & -x & 1 \\ 0 & 0 & 0 & -x \\ 0 & 0 & 0 & y \\ 0 & 0 & 0 & 0 \end{pmatrix},
$$
and
$$
\epsilon = \begin{pmatrix} x &  -1 & 0 & 0 \\ y & 0 & 1 & 0 \end{pmatrix}: F \to D.
$$
Now, take $A = \begin{pmatrix} -1 & 0 & 0 & 0 \\ x & -1 & 0 & 0 \\ y & 0 & 1 & 0 \\ 0 & -y & -x & -1\end{pmatrix}$, so that
$$
A \del_F A^{-1} = \begin{pmatrix} 0 & 0 & 0 & -1 \\ 0 & xy&-x^2&0 \\ 0 & y^2 & -xy&0 \\ 0 & 0 & 0 & 0 \end{pmatrix}.
$$
Observe that $(F, A\del_F A^{-1}) \cong (F, \del_F)$ is a direct sum of $(D, \del_D)$ and a trivial object.
\iffalse
Suppose $(D, \del_D)$ has a minimal free flag resolution $\eta : (G, \del_G) \to (D, \del_D)$. Since $\cone(\eta)$ is exact, we have a short exact sequence\daniel{I don't understand what you're driving at here.  By uniqueness of minimal free resolutions, $G$ would have to be $D$.  So the question is just wehther $D$ itself admits a flag structure, right?  Which was resolved by ABI?}
$$
0 \to \ker(\del_{{\cone}(\eta)}) \to \cone(\eta) \to \ker(\del_{{\cone}(\eta)}) \to 0.
$$
We therefore have $\on{rank}(\cone(\eta) ) = 2 \on{rank} \ker(d_{{\cone}(\eta)})  $, and so $G$ must have even rank. This forces $\on{rank}(G) = 2$. A rank 2 flag has differential of the form
$$
\begin{pmatrix}
0 & 0 \\
p & 0 \\
\end{pmatrix},
$$
whose homology is $R/p \ncong k$, a contradiction. By Theorem \ref{uniqueness}, $(D, \del_D)$ therefore has no minimal free flag resolution.
\fi
%We have $H(D, \del_D) \cong k$, generated by $\begin{pmatrix} x \\ y \end{pmatrix}$. There is a free flag resolution of $(D, \del_D)$ given by
%$$
%F = R(-1) \oplus R \oplus R \oplus R(-1),
%$$
%$$
%\del_F = \begin{pmatrix} 0 & -y & -x & -1 \\ 0 & 0 & 0 & -x \\ 0 & 0 & 0 & y \\ 0 & 0 & 0 & 0 \end{pmatrix},
%$$
%and
%$$
%\epsilon = \begin{pmatrix} x &  -1 & 0 & 0 \\ y & 0 & 1 & 0 \end{pmatrix}: F \to D.
%$$
%Suppose $(D, \del_D)$ has a minimal free flag resolution $\eta : (G, \del_G) \to (D, \del_D)$. Since $\cone(\eta)$ is exact, we have a short exact sequence
%$$
%0 \to \ker(\del_{{\cone}(\eta)}) \to \cone(\eta) \to \ker(\del_{{\cone}(\eta)}) \to 0.
%$$
%We therefore have $\on{rank}(\cone(\eta) ) = 2 \on{rank} \ker(d_{{\cone}(\eta)})  $, and so $G$ must have even rank. This forces $\on{rank}(G) = 2$. A rank 2 flag has differential of the form
%$$
%\begin{pmatrix}
%0 & 0 \\
%p & 0 \\
%\end{pmatrix},
%$$
%whose homology is $R/p \ncong k$, a contradiction. By Theorem \ref{uniqueness}, $(D, \del_D)$ therefore has no minimal free flag resolution.
\end{example}

\begin{example}
In the category of complexes over a graded or local ring, any complex with bounded homology will admit a minimal free resolution.  If you start with a complex which is free, minimal, and bounded, then it will equal its own minimal free resolution.  However, if the original complex was free and minimal, but not bounded above, then it will generally not equal its minimal free resolution.  For instance, if  $R = k[x]/(x^2)$ and one considers the complex $F$:
$$
0 \to R \xra{x} R(1) \xra{x} R(2) \xra{x} \cdots,
$$
then the minimal free resolution will be the complex $F'$:
$$
\cdots \xra{x} R(-3) \xra{x} R(-2) \xra{x} R(-1) \xra{} 0.
$$
And of course $F'$ is not isomoprhic to $F$.

A similar phenomenon occurs for differential modules: namely one can find a free, minimal differential module which is not isomorphic to its minimal free resolution.  Essentially the same example works.  Consider the differential module $(D, \del_D)$ obtained from the complex $F$ by forgetting the homological grading. Let $(D', \del_D')$ be the differential module obtained from $F'$ in a similar way.  The homological grading on $F'$ can realize $F'$ as a free, flag and the quasi-isomorphism of complexes $F'\xra{x} F$ shows that $(D', \del_D')$ is a flag, free resolution of $D$.  Of course, $D'$ is not isomorphic to $D$ because the underlying graded modules are distinct. By the uniqueness of minimal free resolutions,  it follows that $D$ is not a minimal free resolution of itself. 
\end{example}

\begin{rem}
Results similar to these are proven Avramov-Foxby-Halperin's unpublished notes, but with boundedness assumptions that are not satisfied in our setting. \michael{Fill this in.}
\end{rem}

%%
\iffalse
\begin{example}
When $R$ is a graded algebra over a field hypotheses as above, $\Tor(M,k)$ computes
\end{example}
\fi
%%

\michael{Fill in transition to/motivation for following lemma:}

\begin{lemma}\label{lem:ZZ to flag}
Let $R$ be a non-negatively $\ZZ$-graded ring. and let $(F,\del)$ be a free graded differential $R$-module.  Assume $\del F\subseteq R_+F$.  For any integer $d$, $(F,\del)$ may be realized as an extension of free differential modules
\[
(F_{<d}, \del|_{F_{<d}}) \overset{\epsilon}{\to} (F_{\geq d}, \del|_{F_{\geq d}}).
\]
The differential module $(F_{<d}, \del|_{F_{<d}}) $ has a natural split flag structure where $\mathcal F^i$ consists of all summands of the form $R(-i)$.  In particular, if $F$ has at most finitely many generators of degree $i$ for each $i$, then $(F_{<d}, \del|_{F_{<d}}) $ is the minimal free resolution of $ (F_{\geq d}, \del|_{F_{\geq d}})$.

A similar statement holds for non-positively $\ZZ$-graded rings.
\end{lemma}
\begin{proof}
The differential $\del$ has a block decomposition of the form:
\[
\begin{pmatrix}
\del|_{F_<d} & \epsilon\\
0 & \del|_{F\geq d}
\end{pmatrix}
\]
The rest of the statement is straightforward, though we need a hypothesis to guarantee uniqueness of minimal free resolutions.
\end{proof}




%%%%%%%%%%%
\section{The toric BGG correspondence}
\label{BGGsection}
%%%%%%%%%%%

Let $k$ be a field and $V$ a $k$-vector space with basis $\{e_0, \dots, e_n\}$. Denote by $x_0, \dots, x_n$ the corresponding basis elements of $W = \Hom_k(V, k)$. Let $E = \bigwedge(V)$ and $S = \Sym(W)$. Equip $S$ (resp. $E$) with a $\Z$-grading such that $|x_i| = 1$ (resp. $|e_i| = -1$) for all $i$. The following theorem is called the \emph{Bernstein-Gel'fand-Gel'fand correspondence}:

\begin{thm}[\cite{BGG}] 
Let $\Com(S)$ (resp. $\Com(E)$) denote the category of complexes of graded $S$-modules (resp. $E$-modules). There is an adjunction 
$$
\LL_{\on{st}} : \Com(E) \rightleftarrows \Com(S) : \RR_{\on{st}} 
$$
that induces an equivalence
$$
\Db(E) \simeq \Db(S).
$$
\end{thm}
The subscript ``$\on{st}$" stands for ``standard" and is intended to distinguish these classical BGG functors from the analogous functors introduced below in the toric setting.

\begin{rem}
All $E$-modules are right modules. However, a right $E$-module $M$ can be considered as a left $E$-module with action $em = (-1)^{|e||m|}me$, and vice versa.
\end{rem}

We recall the definitions of the functors $\LL_{\on{st}}$ and $\RR_{\on{st}}$. If $N$ is a graded $E$-module, thought of as an object in $\Com(E)$ concentrated in degree 0, $\LL_{\on{st}}(N)$ is the complex with
$$
\LL_{\on{st}}(N)_j = N_m \otimes_k S(-j)
$$
and differential given by multiplication on the right by $\sum_{i = 0}^n e_i \otimes x_i$. The functor $\LL_{\on{st}}$ is extended to complexes by applying the above formula to each term and taking the direct sum totalization of the resulting bicomplex. If $M$ is a graded $S$-module, the complex $\RR_{\on{st}}(M)$ has terms
$$
\RR_{\on{st}}(M)_j = M_{-j} \otimes_k \om(j), 
$$
where $\om = \Hom_k(E, k)$; the notation ``$\om$" for this module will be explained in Section \ref{FM}. Note that $\om$ is (non-canonically) isomorphic to $E(-n-1)$. The differential on $\RR_{\on{st}}(M)$ is multiplication on the right by $ \sum_{i = 0}^n x_i \otimes e_i$. One extends $\RR_{\on{st}}$ to complexes in the same way as $\LL_{\on{st}}$. 




Now, let $A$ be an abelian group, let $a_0, \dots, a_n \in A$, and equip $S = \Sym(W)$ with the $A$-grading given by $|x_i| = a_i$. We wish to formulate a ``toric" BGG correspondence involving the category $\Com(S)$ of complexes of $A$-graded $S$-modules. This requires a bit of care, as the following example illustrates:

\begin{example}
\label{grading}
Suppose $S = k[x_0, x_1]$ is equipped with the $\Z$-grading such that $|x_0| = 1$ and $|x_1| = 2$. Take $E= \Lambda(e_0, e_1)$, $\Z$-graded such that $|e_0| = -1$ and $|e_1| = -2$. Let $M$ be a graded $S$-module, and take $\RR(M) = \bigoplus_{j \in \Z} M_{-j} \otimes_k \om(j)$. Notice that the square-zero endomorphism $\del_{\RR} = x_0 \otimes e_0 + x_1 \otimes e_1$ of $\RR(M)$ does not respect the homological grading $\RR(M)_j = M_{-j} \otimes_k \om(j)$. One has the same problem defining the functor $\LL$. \michael{Add picture of this ``complex."}
\end{example}

A solution to the problem in Example \ref{grading} is as follows:
\begin{enumerate}
\item We equip the exterior algebra $E = \Lambda(V)$ with an $A \times \Z$-grading given by $|e_i| = (-a_i, -1)$, and we only consider $A \times \Z$-graded $E$-modules. We call the additional $\Z$-grading the \emph{auxiliary grading} of $E$. This extra grading allows us to define a homological grading on the output of the functor $\LL$. \daniel{I'm tempted to use a notation like $(a;1)$ instead of $(a,1)$, though I could be talked out of this.} \michael{I don't have a strong opinion on this.}
\item We want to consider all $A$-graded $S$-modules, and not only those equipped with an additional auxiliary grading. We therefore do not impose a homological grading on the image of the functor $\RR$; instead, we allow $\RR$ to take values in the category $\DM(E) := \DM(E , (0, -1))$ of degree $(0, -1)$ differential $E$-modules.
\end{enumerate}

With these modifications, one can use essentially the same arguments as in the classical setting to prove a toric analogue of the BGG correspondence: see Corollary \ref{bounded} below. Since many of the ingredients in the proof will be useful later on, we give a detailed proof here, closely following the exposition in \cite[Sections 2 and 3]{EFS}.

\begin{rem}
The idea of using differential modules to generalize the BGG correspondence is not new; for instance, Rouquier uses a similar strategy in \cite[Section 4]{rouquier} to give an analogue of the BGG correspondence for non-graded polynomial and exterior algebras. An equivalent formulation of the toric BGG correspondence is also stated by Baranovsky in \cite{baranovsky}. \michael{It's actually stated without proof in Baranovsky's paper, at the end of the proof of Theorem 8. Not sure how fine a point we want to put on this...}
\end{rem}

%%%
\iffalse
 it is stated in the proof of \cite[Theorem 8]{baranovsky} that there is an equivalence of categories between $\Db(S)$ and $\Db(E)$, where $E$ is considered as a dg-algebra with trivial differential and homological grading induced by the ``auxiliary" $\Z$-grading defined above.
\fi
%%%

\daniel{I think we want to include the functor $\RR_I$ where $I\subseteq \{1, \dots, n\}$ and the differential is $\sum_{i\in I} x_i\otimes e_i$.  These restricted differentials play a key role in the Tate resolution stuff.} \michael{I agree. Not sure we should expect these functors to be adjoints, by the way. The map $\RR_I$ is given by extending scalars to the smaller set of variables, applying $\RR$, and then restricting scalars back to the larger set of variables; the problem is that extension of scalars is a left adjoint, while $\RR$/restriction of scalars are right adjoints.}

%%%
\iffalse
In the BGG correspondence for the standard $\ZZ$-graded polynomial ring, there are adjoint functors $\RR$ and $\LL$, which give equivalences of categories between $D(S)$ and $D(E)$.  

Famously, under the functor $\RR$,  the standard $\ZZ$-grading of the $S$-modules becomes the homological grading on $D(E)$ side, and the homological grading on $D(S)$ becomes the $\ZZ$-grading of the $E$-modules.  (A similar statement holds for $\LL$.)

Things are more subtle if $S$ has a nonstandard grading, though a similar exchange still holds.  In this section, we will define adjoint functors $\RR$ and $\LL$ which give equivalences of categories between the derived category of $S$-modules and the derived category of differen \daniel{got interrupted while editing\dots}
\fi
%%%%%
We start by defining functors
$$
\LL : \DM(E) \leftrightarrows \Com(S) : \RR.
$$
If $(N, \del_N) \in \DM(E)$, $\LL(N, \del_N)$ is the complex with terms
$$
\LL(N, \del_N)_j = \bigoplus_{a \in A} N_{(a, j)} \otimes_k S(-a)
$$
and differential $\del_{\LL} = \sum_{i = 0}^n e_i \otimes x_i + (-1)^j \del_N$. 


%%%%%%%%%%%%%
\iffalse
Define a functor
$$
\wLL : \on{Com}(E) \to \on{Com}(S)
$$
as follows. For an $E$-module $N$ concentrated in degree 0, $\wLL(N)$ is the complex with
$$
\wLL(N)_q = \bigoplus_{d \in A} N_{(-d, -q)} \otimes_k S(d)
$$ 
and differential
\begin{equation}
\label{koszuldiff}
m \otimes s \mapsto \sum_{i = 0}^n e_im \otimes x_is.
\end{equation}
For a general complex $(C, \del) \in \on{Com}(E)$, we form the bicomplex
\begin{equation}
\label{bicomplex}
\xymatrix{ 
& \ar[d] & \ar[d]  & \\
\cdots & \wLL(C_{p})_{q}\ar[l]_-{ \del}  \ar[d]     & \wLL(C_{p + 1})_q   \ar[d] \ar[l]_-{ \del} & \cdots \ar[l]_-{\del} \\
\cdots & \wLL(C_{p })_{q- 1} \ar[d] \ar[l]_-{\del} &  \wLL(C_{p+1})_{q-1} \ar[d] \ar[l]_-{\del} & \ar[l]_-{\del}  \cdots \\
&&&
}
\end{equation}
and apply $\on{Tot}^{\oplus}( - )$, where the vertical differential $ \wLL(C_{p})_{q} \to  \wLL(C_{p})_{q-1}$ is the dual Koszul map (\ref{koszuldiff}) multiplied by $(-1)^p$. 

Now, if $D \in \DM(E)$, then it makes sense to apply the functor $\wLL$ to $\Ex(D) \in \Com(E)$. The object $\wLL(\Ex(D))$ has some extra structure arising from the periodicity of $\Ex(D)$ that we now wish to exploit. The $(p,q)$ term of the bicomplex whose totalization is $\wLL(\Ex(D))$ is 
$$
\bigoplus_{d \ge 0} (D(0, -p))_{(-d, -q)} \otimes S(d) = \bigoplus_{d \in A} D_{(-d, -p-q)} \otimes S(d),
$$
and so
$$
\wLL(\Ex(D))_m = \bigoplus_{p \in \Z}  \bigoplus_{d \in A} D_{(-d, -m)} \otimes S(d).
$$
Notice that the summands do not depend on $p$. Equip each $\wLL(\Ex(D))_m$ with a $k[u]$-module structure determined by the following ``shift" operation: if $t = (\dots, t_{-1}, t_0, t_1, \dots) \in \bigoplus_{p \in \Z}  \bigoplus_{d \in A} D_{(-d, -m)} \otimes S(d)$,
$$
u(t)_p = (-1)^{m - p} t_{p - 1}. 
$$

\begin{prop}
\label{ulinear}
The differential on $\wLL(\Ex(D))$ is $k[u]$-linear.
\end{prop}
\michael{I only wrote this proof out to make sure it's correct. Probably this should be omitted in the paper.}\daniel{Agreed.}
\begin{proof}
We omit the verification as it is a straightforward computation.
\iffalse
I'm writing down the proof to make sure I got the sign right in the definition of the $u$-action. We prove that the action of $u$ commutes with both horizontal and vertical differentials. Write $d_D$ for the differential on $D$ and $d_K$ for the dual Koszul differential. We have
\begin{align*}
d_{\on{hor}}(u \cdot (\dots, t_{-1}, t_0, t_1, \dots)) &= d_{\on{hor}}(\dots, (-1)^{m-1}t_{-2}, (-1)^{m} t_{-1}, (-1)^{m-1}t_0, \dots) \\
&= (\dots, (-1)^{m}d_T(t_{-3}), (-1)^{m-1} d_T(t_{-2}), (-1)^{m}d_T(t_{-1}), \dots) \\
&= u \cdot (\dots, d_T(t_{-2}),  d_T(t_{-1}), d_T(t_{0}), \dots) \\
& = u \cdot d_{\on{hor}} (\dots, t_{-1}, t_0, t_1, \dots),
\end{align*}
and 
\begin{align*}
d_{\on{ver}}(u \cdot (\dots, t_{-1}, t_0, t_1, \dots)) &= d_{\on{ver}}(\dots, (-1)^{m-1}t_{-2}, (-1)^{m} t_{-1}, (-1)^{m-1}t_0, \dots) \\
&= (\dots, (-1)^{m}d_K(t_{-2}), (-1)^{m} d_K(t_{-1}), (-1)^{m}d_K(t_{0}), \dots) \\
&= u \cdot (\dots, -d_K(t_{-1}),  d_K(t_{0}), -d_K(t_{1}), \dots) \\
& = u \cdot d_{\on{ver}} (\dots, t_{-1}, t_0, t_1, \dots).
\end{align*}
\fi
\end{proof}

Define 
$$
\LL(D) := \wLL(\Ex(D)) / (u - 1).
$$
We have an isomorphism
\begin{equation}
\label{iso}
\LL(D)_m \cong \bigoplus_{d \in A} D_{(-d, -m)} \otimes S(d)
\end{equation}
given by representing each class in $\LL(D)_m$ by an element concentrated in the $p = 0$ summand of $\bigoplus_{p \in \Z}  \bigoplus_{d \in A} D_{(-d, -m)} \otimes S(d)$. Via this isomorphism, the $m^{\th}$ differential on $\LL(D)$ is given by $(-1)^{m}d_D + \sum_{i = 0}^n e_i \otimes x_i$.

\fi
%%%%%%%%%%







If $M$ is an $S$-module concentrated in degree 0, the differential module $\RR(M)$ has underlying module
$$
\bigoplus_{d \in A} M_{-d} \otimes \om(d, 0),
$$
where, as in the classical BGG correspondence, $\om$ denotes the $E$-module $\Hom_k(E, k)$. Here, $\om$ is (non-canonically) isomorphic to $E(-\sum_{i = 0}^n a_i, -n-1)$. The differential on $\RR(M)$ is given by $\del_\RR = \sum_{i = 0}^n x_i \otimes e_i$.
Given an object $C \in \Com(S)$, we define $\RR(C)$ as follows: form a bicomplex with $q^{\th}$ row given by the expansion $\Ex(\RR(C_q))$ and $p^{\th}$ vertical differential given by $(-1)^p\del_C$, apply $\on{Tot}^{\oplus}( - )$ to get an object in $\Comper(E, (0,-1))$, and apply the equivalence in Section \ref{expansion} to obtain an object in $\DM(E)$. Explicitly: $\RR(C)$ has underlying module $\bigoplus_{j \in \Z} \RR(C_j)(0, -j)$ and differential $\del_\RR$ that acts by $ \sum_{i = 0}^n x_i \otimes e_i + (-1)^j\del_C$ on the summand $\RR(C_j)(0, -j)$.

%%%%%%
\iffalse
\begin{equation}
\label{bicomplex}
\xymatrix{ 
& \ar[d]^-{\del}   & \ar[d]^-{\del}   & \\
\cdots & \RR(C_q)_p\ar[l]  \ar[d]^-{ \del}     & \RR(C_{q})_{p+1}   \ar[d]^-{ \del}  \ar[l]& \cdots \ar[l]\\
\cdots & \RR(C_{q - 1})_p\ar[d]^-{\del} \ar[l] &  \RR(C_{q -1})_{p+1} \ar[d]^-{\del}  \ar[l]& \ar[l]\cdots \\
&&&
}
\end{equation}
\fi
%%%%%%

\begin{remark}\label{rmk:PPn DM is complexes}
When $A = \Z$ and $a_i = 1$ for all $i$, our toric BGG functors are essentially the same as the classical ones. In detail: recall that $\Com(E)$ denotes the category of complexes of $\Z$-graded $E$-modules, where $E$ is equipped with the $\Z$-grading given by $|e_i| = -1$; while $\DM(E)$ is the category of degree $(0, -1)$ differential $E$-modules, where $E$ is $\Z \times \Z$-graded such that $|e_i| = (-1, -1)$. In this case, there is an equivalence (in fact, an isomorphism) of categories
$$
\Com(E) \simeq \DM(E)
$$
given as follows. Noting that any $\Z$-graded $E$-module $N$ may be considered as a $\Z \times \Z$-graded $E$-module with components $N_{(i, i)} = N_i$ and $N_{(i, j)} = 0$ for $i \ne j$, we define a functor
$$
\on{Fold} : \Com(E) \to \DM(E)
$$
given by $(\cdots \xra{\del_C} C_j \xra{\del_C} C_{j-1} \xra{\del_C} \cdots) \mapsto (\bigoplus_{j \in \Z} C_j(0, -j), \del_C).$ If $(N, \del_N) \in \DM(E)$, we set
$$
N_j = \{n \in N \text{ : } |n| = (a, i), \text{ where } i - a = j\}.
$$
Notice that $N_j$ is a submodule of $N$. Since $\del_N$ is a map from $N$ to $N(0, -1)$, $\del_N$ induces a map from $N_j$ to $N_{j -1}$ for all $j$. Noting that any $\Z \times \Z$-graded $E$-module $M$ can be considered as a $\Z$-graded $E$-module with components $M_a = \bigoplus_{i  \in \Z} M_{(a, i)}$, we define a functor
$$
\on{Unfold} : \DM(E) \to \Com(E)
$$
by $(N, \del_N) \mapsto (\cdots \xra{\del_N} N_j \xra{\del_N} N_{j-1} \xra{\del_N} \cdots ).$ It's easy to check that $\on{Fold}$ and $\on{Unfold}$ are inverses. Moreover, we have $\LL = \LL_{\on{st}} \circ \on{Unfold}$ and $\RR = \on{Fold} \circ \RR_{\on{st}}$.
\end{remark}



\begin{prop}
The functors
$$
\LL :  \DM(E) \leftrightarrows \Com(S) : \RR
$$
form an adjunction.
\end{prop}

\begin{proof}
To start, let $M$ be an $S$-module, and let $(N, \del_N)$ be a differential $E$-module. We have
\begin{align*}
\Hom_S( \LL(N)_j, M) &= \Hom_S(\bigoplus_{a \in A} N_{(a, j)} \otimes_k S(-a), M) \\
&=  \prod_{a \in A} \Hom_k ( N_{(a, j)} , M_a)\\
\end{align*}
Now, let $C$ be a complex of $S$-modules. By the above reasoning, $\Hom_{\Com(S)}( \LL(N, \del_N), C)$ is the subspace of 
$$
\prod_{a \in A, j \in \Z} \Hom_k ( N_{(a, j)} , (M_j)_{a})
$$
given by morphisms that commute with the differentials. On the other hand, the space $\Hom_{\DM(E)}((N, \del_N), \RR(C))$ is the subspace of 
\begin{align*}
\Hom_E(N, \bigoplus_{a \in A, j \in \Z} (M_j)_{-a} \otimes_k \om(a, -j)) &= \prod_{a \in A, j \in \Z}\Hom_E(N,  \Hom_k(E(-a, j), (M_j)_{-a}  ))  \\
&=   \prod_{a \in A, j \in \Z} \Hom_k(N(-a, j),  (M_j)_{-a} ) \\
&=  \prod_{a \in A, j \in \Z} \Hom_k(N_{(-a, j)},   (M_j)_{-a} )
\end{align*}
given by morphisms that commute with the differentials; the first equality holds because each $(M_j)_{-a} \otimes_k \om(a, -j)$ is 0 in all but finitely many degrees. Reindexing by replacing $a$ with $-a$, we get
$$
\prod_{a \in A, j \in \Z} \Hom_k(N_{(a, j)},   (M_j)_{a} ),
$$
as desired. Finally, one checks that the requirements imposed by compatibility with the differentials coincide.\end{proof}


Just as in the classical setting, the functors $\LL$ and $\RR$ are not inverses, but they are inverses up to quasi-isomorphism. Before we prove this, we record the following calculation of the homology of the functors $\LL$ and $\RR$.

\begin{prop}[cf. \cite{EFS} Proposition 2.3]
\label{tor} 
Let $C \in \Com(S)$, and let $N$ be a finitely generated $A \times \Z$-graded $E$-module. We have
\begin{itemize}
\item[(a)] $H(\RR(C))_{(a, j)} = \on{Tor}_j^S(C, k)_a$, and
\item[(b)] $H_j(\LL(N))_a=\Ext^{\DM}_E(k, N)_{(a, j)}$.
\end{itemize}
\end{prop}
\michael{The finiteness hypothesis on $N$ is not present in \cite[Proposition 2.3]{EFS}, but I think it may be necessary here. See my comment in the proof. Please double check me on this; perhaps I'm wrong and the finiteness assumption isn't necessary!}

\begin{proof}
We can view the Koszul complex $K$ on the variables of $S$ as the complex of $A$-graded $S$-modules with homological degree $j$ component $\bigoplus_{d \in A} S(-d) \otimes_k \om_{(d, j)}$ and differential  given by multiplication by $\sum_{i = 0}^n x_i \otimes e_i$. We have:
\begin{align*}
\RR(C)_{(a, j)} &= (\bigoplus_{ i \in \Z} \RR(C_i)(0,-i))_{(a, j)} \\
& = (\bigoplus_{i \in \Z} \bigoplus_{d \in A} (C_i)_{-d} \otimes_k \om(d, -i))_{(a, j)} \\ 
& = \bigoplus_{i \in \Z} \bigoplus_{d \in A} (C_i)_{-d} \otimes_k \om_{(d+a, j - i)} \\
& = \bigoplus_{i \in \Z} \bigoplus_{d \in A} (C_i(-d))_a \otimes_k \om_{(d, j - i)}  \\
& = (\bigoplus_{ i \in \Z} C_i \otimes_S K_{j - i})_a \\
& = ((C \otimes_S K)_{j})_a.
\end{align*}
This equality identifies cyles in $\RR(P)_{(a, j)}$ with $j$-cycles in $(C \otimes_S K)_a$, and similarly for boundaries. This proves (a). As for (b): 
\begin{align*}
(\LL(N)_j)_a &= (\bigoplus_{d \in A} N_{(d, j)} \otimes_k S(-d))_a\\
& = \bigoplus_{d \in A} N_{(d, j)} \otimes_k S_{a-d} \\
& = \bigoplus_{d \in A} S_{-d} \otimes_k N_{(d + a, j)} \\
& =  \bigoplus_{d \in A} S_{-d} \otimes_k N(-w + d , -n -1)_{(w + a, j + n + 1)} \\
& =  (\bigoplus_{d \in A} S_{-d} \otimes_k \om(d, 0) \otimes_E N)_{(w + a, j + n + 1)} \\
&= (\RR(S) \otimes^{\DM}_E N)_{(w + a, j + n + 1)} \\
&= \underline{\Hom}_E^{\DM}(\RR(S)^\vee, N)_{(w + a, j + n + 1)}. 
\end{align*}
The last equality follows since $N$ is finitely generated. \michael{The reason finitely generated is necessary is that pulling a direct sum out of the first component of $\Hom$ gives a product. Even the fact that we're in the graded setting doesn't seem to help us avoid this. Note that, in \cite{EFS}, there is a homological grading, and each term of the complex $\RR(S)^\vee$ is finitely generated, so this problem doesn't arise. Maybe we should include a comment about this?} As above, this equality identifies $j$-cycles in $\LL(N)_a$ with cycles in $\Hom_E(\RR(S)^\vee, N)_{(w + a, j + n + 1)}$. Finally, note that $\RR(S)^\vee(w, n+1)$ is a free flag resolution of the residue field $k$, considered as an object in $\DM(E)$ with trivial differential.
\end{proof}

\begin{cor}\label{cor:RM high degree} Let $C \in \Com(S)$. If $C$ is bounded with finitely generated terms, then $\dim_kH(\RR(C)) < \infty$.
\end{cor}


\begin{prop}(cf. \cite{EFS} Theorem 2.6)
\label{resolutions}
Let $C \in \Com(S)$ and $N \in \DM(E)$. There is a natural surjective quasi-isomorphism $(\LL \circ \RR)(C) \xra{\simeq} C$ and a natural injective quasi-isomorphism $N \xra{\simeq} (\RR \circ \LL)(N)$.
\end{prop}

\michael{I'm resisting calling these quasi-isomorphisms ``resolutions", because I'm not sure this is the right word. For instance, $(\LL \circ \RR)(C) \to C$ is a surjective quasi-isomorphism of a free complex onto $C$, but $(\LL \circ \RR)(C)$ isn't necessarily a projective object in the category of complexes, because it isn't necessarily bounded on the right. Maybe I'm begin overly picky here.}

\michael{A paranthetical at the end of the proof of \cite[Theorem 2.6]{EFS} says that $(\LL \circ \RR)(M)$ is isomorphic to $M \otimes_k K$, where $K$ is the Koszul complex and the $S$-action on $M \otimes_k K$ is the diagonal action. But I don't understand how this could be. For instance, take $M = k[x]/(x^2)$. The $S$-action on $M \otimes_k K$ is given by $x(m \otimes v) = xm \otimes xv$. But this means $x (x \otimes 1) = 0$, i.e. $M \otimes_k K$ has torsion. But of course $(\LL \circ \RR)(M)$ is free. Am I misunderstanding what is meant by ``diagonal action"?

Even if we attempt to resolve the above problem by defining the $S$-module action so that $S$ only acts on $K$, the statement remains false. Again, take $M = k[x]/(x^2)$. Then $M \otimes_k K$ is just a direct sum of two Koszul complexes, so it's a free resolution of two copies of $k$. But, $(\LL \circ \RR) (M)$ is a free resolution of $k[x]/(x^2)$. So, the two complexes can't even be quasi-isomorphic (although one can check they are isomorphic as modules).}
%%%%


\begin{proof}
For any $a \in A$ and $i \in \Z$, we have
\begin{align*}
((\LL \circ \RR)(C)_i)_a &= \bigoplus_{d \in A} \RR(C)_{(d, i)} \otimes_k S_{a - d} \\
&= \bigoplus_{d \in A} \bigoplus_{j \in \Z} \RR(C_j)(0, -j)_{(d, i)} \otimes_k S_{a - d} \\
&= \bigoplus_{d \in A} \bigoplus_{j \in \Z} \bigoplus_{b \in A} (C_j)_{-b} \otimes_k \om_{(b + d, i - j)} \otimes_k S_{a - d}. \\
&= \bigoplus_{j \in \Z} \bigoplus_{d \in A} \bigoplus_{b \in A} (C_j)_b \otimes_k   \om_{(d, i - j)} \otimes_k S(-d)_{a - b} \\
&= \bigoplus_{j \in \Z} \bigoplus_{d \in A} (C_j \otimes_k   \om_{(d, i - j)} \otimes_k S(-d))_a \\
&= \bigoplus_{j \in \Z} (C_j \otimes_k  (\LL \circ \RR)(k)_{i - j} )_a \\
&= ((C \otimes_k  (\LL \circ \RR)(k))_i)_a,
\end{align*}
and 
\begin{align*}
(\RR \circ \LL)(N)_{(a, i)} &= \bigoplus_{j \in \Z} (\RR(\LL(N)_j)(0, -j))_{(a, i)} \\
&= \bigoplus_{j \in \Z}  \bigoplus_{d \in A} (\LL(N)_j)_{-d} \otimes_k \om_{(a + d, i-j)} \\
&= \bigoplus_{j \in \Z}  \bigoplus_{d \in A} \bigoplus_{b \in A} N_{(b,j)} \otimes_k S_{-b-d} \otimes_k \om_{(a + d, i-j)} \\
&= \bigoplus_{(a,j) \in A \times \Z} N_{(b,j)} \otimes_k (\RR \circ \LL)(k)_{(a-b,i-j)} \\
&= (N \otimes_k (\RR \circ \LL)(k))_{(a, i)}.
\end{align*}
We therefore have an identification $(\LL \circ \RR)(C)_i = (C \otimes_k  (\LL \circ \RR)(k))_i$ of $A$-graded $S$-modules for all $i \in \Z$ and an identification $(\RR \circ \LL)(N) = N \otimes_k (\RR \circ \LL)(k)$ of $A \times \Z$-graded $E$-modules, where the module action is on the right tensor factor in both cases.

Note that $(\LL \circ \RR)(k)$ is the Koszul complex on the variables of $S$. There is a natural map of $S$-modules $(\LL \circ \RR)(k) \to k$, and tensoring this map over $k$ with $\id_C$ gives a surjective chain map $f: (\LL \circ \RR)(C) \to C$. Similarly, there is a natural $E$-module map $k \to (\RR \circ \LL)(k)$, and tensoring this map over $k$ with $\id_N$ gives an injective morphism of differential modules $g: N \to (\RR \circ \LL)(N)$. One easily checks that $f$ is also surjective on homology and $g$ is injective on homology. \michael{We should probably mention that the first map is the counit of adjunction and the second map is the unit, just for completeness (I haven't checked this carefully, but I'd be surprised if this wasn't true). But I don't think we need this.}

Every object in $\Com(S)$ is a filtered colimit of bounded complexes of finitely generated modules, and every object in $\DM(E)$ is a filtered colimit of differential submodules whose underlying modules are finitely generated. To see the second statement, let $D \in \DM(E)$, and let $\{D_i \}_{i \in I}$ be the set of all submodules of $D$; since $D$ is the direct limit of the $D_i$, $(D, \del)$ is the direct limit of the differential modules $(D_i + \del(D_i)(1), \del)$. The functor $\LL$ preserves colimits since it is a left adjoint, and it is easy to prove the functor $\RR$ preserves colimits as well. Since filtered colimits are exact, we may assume $C$ is a bounded complex of finitely generated modules and $N$ is finitely generated. By exactly the same argument as in the proof of \cite[Theorem 2.6]{EFS}, we may further reduce to the case where $C$ is a module $M$ concentrated in degree 0. 

We now show that $f$ is a quasi-isomorphism. Let $\m$ denote the homogeneous maximal ideal of $S$, set
$$
A^i = \{ a \in A \text{ : } M_a \cap \m^i M = 0\},
$$
and equip $M$ with the $k$-linear filtration 
$$
F^i M = \bigoplus_{a \in A^i} M_a.
$$
Using the identification $(\LL \circ \RR)(M) = M \otimes_k (\LL \circ \RR)(k)$ of $A$-graded $S$-modules, we get an induced filtration of $(\LL \circ \RR)(M)$, as a complex of $A$-graded $k$-vector spaces. Consider the associated spectral sequence with
$$
E^0_{p,q} = F^p (\LL \circ \RR)(M)_{p + q} / F^{p-1} (\LL \circ \RR)(M)_{p + q} 
$$
and
$$
E^1_{p,q} = H_{p + q} E^0_{p,*}.
$$
Since the filtration is bounded below and exhaustive, the spectral sequence converges to $H_{p+q}(\LL \circ \RR)(M)$. We have $E^1_{p,p} = F^p M / F^{p-1}M$, and $E^1_{p,q} = 0$ for $p \ne q$. The spectral sequence therefore degenerates at page 1; we conclude that the homology of $(\LL \circ \RR)(M)$ is concentrated in degree 0, and $H_0(\LL \circ \RR)(M)$ has the same Hilbert function as $M$. Since $f$ is injective on homology and $M$ is finitely generated, $f$ is a quasi-isomorphism.

Finally, we show $g$ is a quasi-isomorphism. The bicomplex $\B$ whose totalization is $(\Ex \circ \RR \circ \LL)(N)$ has $q^{\th}$ row given by
$$
\cdots \to \RR( \LL(N)_q ) (0, 1) \to \RR( \LL(N)_q ) \to \RR( \LL(N)_q ) (0, -1) \to \cdots
$$
and $p^{\th}$ vertical differential given by $(-1)^p\del_{\LL(N)}$. Since $N$ is finitely generated, $\LL(N)$ is a bounded complex; it follows that $\B$ has only finitely many rows, and so the associated spectral sequence whose $E^1$ page is the horizontal homology of $\B$ converges to $H_*(\Ex \circ \RR \circ \LL)(M)$. By Proposition \ref{tor}, $H(\RR(S)) \cong k$; it follows that
$$
E^2_{p,q} = \bigoplus_{a \in A} H(N)_{(a, q)} \otimes_k k(-a, p). 
$$
There are no $E$-linear maps between $k(a, p)$ and $k(a', p')$ for $p \ne p'$, so the spectral sequence degenerates at page 2. We conclude that there is an isomorphism of $A$-graded $k$-vector spaces
$$
H(\RR \circ \LL)(N) = H_0(\Ex \circ \RR \circ \LL)(N) \cong H(N).
$$
Since $g$ is injective on homology and $N$ is finitely generated, $g$ is a quasi-isomorphism.
\end{proof}

The \emph{derived category of differential $E$-modules} $\on{D}_{\DM}(E)$ is obtained by inverting quasi-isomorphisms in $\DM(E)$. It is easy to check that the functors $\LL$ and $\RR$ are exact, and so they factor through the derived categories $\on{D}_{\DM}(E)$ and $\on{D}(S)$. 

\begin{cor} 
\label{derived}
The functors
$$
\LL : \on{D}_{\DM}(E) \leftrightarrows \on{D}(S) : \RR
$$
are inverse equivalences.
\end{cor}

The \emph{bounded derived category of differential $E$-modules} $\Db_{\DM}(E)$ is defined to be the subcategory of $\on{D}_{\DM}(E)$ given by objects with finitely generated homology. Denote by $\on{D}^{\on{fg}}_{\DM}(E)$ the subcategory of $\Db_{\DM}(E)$ given by objects whose underlying module is finitely generated. 

%%%%%%%%%%%%%%%%%%%%
\iffalse
We first fix some notation. If $(N, \del) \in \DM(E)$ and $i \ge \Z$, let $N_i = \bigoplus_{a \in A} N_{(a, i)}$. For $j \in \Z$, let $\tau_{\ge j} N$ denote the $E$-submodule of $N$ generated by $(\bigoplus_{i > j} N_i) \oplus \ker(\del |_{N_{j}})$; note that this is a differential submodule of $(N, \del)$. Define $\tau_{\le j} = \cone(\tau_{\ge j + 1}N  \into N)$. 

\begin{lemma}
\label{truncation}
Let $N \in \DM(E)$. We have
$$
H(\tau_{\ge j} N)_i = \begin{cases} H(N)_i, & i \ge j \\ 0, & i < j \end{cases}
$$
and
$$
H(\tau_{\le j} N)_i = \begin{cases} H(N)_i, & i \le j \\ 0, & i > j. \end{cases}
$$
\end{lemma}

\begin{proof}
\michael{Fill in.}
\end{proof}
\fi
%%%%%%%%%%%%%%%%%%%

\begin{prop}
\label{fg}
The inclusion 
$$
\on{D}^{\on{fg}}_{\DM}(E) \into \Db_{\DM}(E)
$$
is an equivalence.
\end{prop}

\begin{proof}
Let $N \in \DM(E)$. By Proposition \ref{minresexists}, we can choose a minimal free resolution $F$ of $N$. Since $H(N)$ is finitely generated over $E$, $\dim_k H(N)_{(a, i)} < \infty$ for all $(a, i) \in A \times \Z$. The convergence of the spectral sequence
$$
E^2_{pq} = \Tor_p^R(H_q \on{Ex}(N), k) \Rightarrow \Tor^R_{p + q}(\on{Ex}(N), k)
$$
implies that $\dim_k H(F \otimes k)_{(a, i)} < \infty$ for all $(a, i)$, and it follows that $\dim_k F_{(a,i)} < \infty$ for all $i$. Using again that $H(N)$ is finitely generated over $E$, choose a finite subset $A' \subseteq A$ such that $H(N)_{(a, i)} = 0$ if $a \notin A'$. Let $F'$ denote the $E$-submodule of $F$ generated by elements of degree $(a', i)$ for some $a' \in A$ and $i \in \Z$. Notice that $F'$ is a differential submodule of $F$, and the inclusion $F' \into F$ is a quasi-isomorphism. Finally, we observe that, since $F'$ is minimal, there are only finitely many $i$ such that $F'_{(a', i)} \ne 0$ for some $a' \in A'$. We conclude that $\dim_k F' < \infty$, and so $F'$ is a finitely generated $E$-module. 
\end{proof}

\michael{Is this statement true for general differential modules? Of course it's easy to prove the corresponding fact for complexes, by taking ``smart truncations". But there doesn't seem to be a way to do this with differential modules. This proof extends to somewhat greater generality, but it only extends so far. At the very least, we need to be in a setting where minimal resolutions exist; I think we need several other technical assumptions as well.}

\begin{cor} 
\label{bddderived}
The functors
$$
\LL : \Db_{\DM}(E) \leftrightarrows \Db(S) : \RR
$$
are inverse equivalences.
\end{cor}

\begin{proof}
Combine Corollary \ref{cor:RM high degree} and Proposition \ref{fg}.
\end{proof}

\michael{This section is under construction from here on. I still want to fill in analogues of \cite{EFS} Theorem 3.4 and the Reciprocity Theorem, and of course examples need to be added throughout. The reciprocity theorem will require a notion of injective resolutions for DM's, which we have not developed yet. It would also be great to figure out a connection between regularity on the symmetric side and some notion of acyclicity on the exterior side.}


\begin{defn}
We will call a complex of free modules over $S$ is \emph{linear} if each of its differentials can be expressed as a matrix whose entries are linear forms. If $F$ is a minimal complex of free $S$-modules, we define the \emph{linear part} of $F$, denoted $\on{lin}(F)$, to be the complex obtained by expressing each differential as a matrix and removing the non-linear entries. The definitions of linearity for free differential $E$-modules and the linear part $\on{lin}(N)$ of a minimal free differential $E$-module $N$ are similar.
\end{defn}


\begin{prop}
\label{perturbation}
Let $C \in \Com(S)$ be a bounded above complex, and let $N \in \DM(E)$ be a differential module such that $N_{(a, i)} = 0$ for $i \gg 0$. 
\begin{itemize}
\item[(a)] $\RR(C)$ is homotopy equivalent to a minimal differential module whose linear part  is $\RR(H_*(C))$, where each $H_i(C)$ is considered as a complex concentrated in degree $i$. 
\item[(b)] $\LL(N)$ is homotopy equivalent to a minimal complex whose linear part is $\LL(H(N))$.
\end{itemize}
\end{prop}

\begin{proof}
\label{Under construction}
Since $C$ is bounded, the bicomplex whose totalization is $\RR(C)$ has finitely many rows. Notice that the columns of this bicomplex split, and its vertical homology in position $(p,q)$ is $\bigoplus_{d \in A} H_q(C) \otimes_k \om(d, p)$. Part (a) therefore follows immediately from \cite[Lemma 3.5]{EFS}.

Since $\LL(N)$ is not the totalization of a bicomplex, we need a slightly different argument for part (b). We will use the Basic Perturbation Lemma; see, for instance, \cite[Lemma A.4]{coanda} for the statement. Consider the complex $\overline{\LL(N)}$ with underlying $S$-module identical to $\LL(N)$ and $j^{\th}$ differential $(-1)^j \del_N$. This complex splits $S$-linearly; that is, letting $Z_j$ and $B_j$ denote the $j$-cycles and $j$-boundaries in $\overline{\LL(N)}$, we may choose an $S$-module decomposition
$$
\overline{\LL(N)}_j = B_j \oplus H_j \oplus L_j,
$$
for all $j$ such that $B_j \oplus H_j = Z_j$. For each $j$, let $g_j : L_j \to B_{j -1}$ denote the isomorphism such that the $j^{\th}$ differential $(-1)^j \del_{N}$ on $\overline{\LL(N)}$ can be expressed as
$$
\begin{pmatrix}
0 & 0 & g_j \\
0 & 0 & 0 \\
0 & 0 & 0
\end{pmatrix}.
$$

Using the isomorphism $H_j \cong H_j(\overline{\LL(N)}) \cong \LL(H(N))_j$, we construct an injection $\iota : \LL(H(N)) \into \overline{\LL(N)}$ and a surjection $\pi : \overline{\LL(N)} \onto \LL(H(N))$ such that $\pi \iota = \id$. There is a null homotopy $h$ of $\id  - \iota  \pi$ given, in degree $j$, by 
$$
\begin{pmatrix}
0 & 0 & 0 \\
0 & 0 & 0\\
g_{j+1}^{-1} & 0 & 0
\end{pmatrix}.
$$
As observed in \cite[Section 2.1]{LS}, we may assume without loss that $f  h = 0$, $h \iota = 0$, and $h^2 = 0$. 

The $S$-linear endomorphism $\del_\LL$ of $\overline{\LL(N)}$ is a ``perturbation" of the differential on $\overline{\LL(N)}$, meaning that 
\begin{itemize}
\item $\del_\LL^2 = 0$, and
\item if we add $\del_\LL$ to the differential on $\overline{\LL(N)}$, we again get a complex (namely $\LL(N)$). 
\end{itemize}
\end{proof}

\begin{rem}
We point out that, while the proofs of parts (a) in (b) in Proposition \ref{perturbation} appear different, they are conceptually the same: it was observed by Coand{\u{a}} in \cite[Lemma A.7]{coanda} that \cite[Lemma 3.5]{EFS} can be proven using the Basic Perturbation Lemma, using an argument essentially identical to the one we give for Proposition \ref{perturbation}(b).
\end{rem}





Let $\on{Lin}(S)$ (resp. $\on{Lin}_{\DM}(E)$) denote the category of linear free complexes of $S$-modules (resp. linear free differential $E$-modules).


\begin{prop} [cf. \cite{EFS} Proposition 2.1] Let $\Com_0(S)$ denote the category of complexes of $A$-graded $S$-modules with trivial differential. We have induced equivalences
$$
\LL :  \Mod(E) \xra{\simeq} \on{Lin}(S)
$$
and
$$
\RR :\Com_0(S) \xra{\simeq} \on{Lin}_{\DM}(E).
$$
\end{prop}


\begin{proof}
We prove the first functor is an equivalence; one uses a similar argument for the second. Let $U$ be a $k$-vector space and $e \in V$. Identifying $V$ with $\Hom_k(W, k)$, we get an induced map
$$
e : W \otimes U \to U
$$
given by $w \otimes u \mapsto e(w)u$. Now, let
$$
\cdots \xra{d} \bigoplus_{d \in A}S(d)  \otimes_k N_{d,i}  \xra{d} \bigoplus_{d \in A} S(d) \otimes_k N_{d, i-1} \xra{d} \cdots
$$
be an object in $\on{Lin}(S)$. Let $N = \bigoplus_{d \in A, i \in \Z} N_{d, i}$. Define an $E$-module structure on $N$ as follows. If $n \in N_{d,i}$ and $e \in V$, $e \cdot n = e(d(1 \otimes n)) \in \bigoplus_{d \in A} N_{d, i-1}$. We consider $N$ as an $A \times \Z$-graded $E$-module by defining $N_{(d, i)} = N_{-d, i}$. The relation $d^2 = 0$ implies the relations $N$ must satisfy to be an $E$-module. \michael{Check this last statement, and check that the proof of the second equivalence really is the same.}
\end{proof}



%%%%%%%%%%%%%%%%%%
\section{A Fourier-Mukai definition of the Tate resolution over $\PP^n$}
\label{FM}
%%%%%%%%%%%%%%%%%%

Suppose $S = k[x_0, \dots, x_n]$ is $\Z$-graded with $|x_i| = 1$. In this section, we temporarily revert back to the grading convention for $E = \Lambda_k(e_0, \dots, e_n)$ from the classical BGG correspondence, so that $E$ is $\Z$-graded with $|e_i| = -1$ for all $i$. 

The classical BGG equivalence 
$$
\RR_{\on{st}} : \Db(S) \xra{\simeq} \Db(E)
$$
may be refined to a commutative square
$$
\xymatrix{
\Db(S) \ar[r]^-{\simeq} \ar[d]& \Db(E) \ar[d] \\
\Db(\PP^n) \ar[r]^-{\simeq}& \on{D}_{\on{sing}}(E), \\
}
$$
where $\on{D}_{\on{sing}}(E) := \Db(E) / \Perf(E)$ denotes the \emph{singularity category of $E$}. One of the key insights of Eisenbud-Fl\o ystad-Schreyer in \cite{EFS} is that the ``geometric BGG correspondence" given by the equivalence $\overline{\RR}_{\on{st}}:\Db(\PP^n) \xra{\simeq} \on{D}_{\on{sing}}(E)$ can be used to develop an efficient algorithm for computing sheaf cohomology over $\PP^n$.

To explain the idea, we need an alternative model for the singularity category of $E$. Let $K^{\on{ex}}(E)$ denote the homotopy category of exact complexes of finitely generated free  $\Z$-graded $E$-modules. By a theorem of Buchweitz (\cite[Theorem 4.4.1]{buchweitz}), there is an equivalence 
$$
C: \on{D}_{\on{sing}}(E) \xra{\simeq} K^{\on{ex}}(E)
$$
given as follows. Let $Y$ be a bounded complex of finitely generated $E$-modules. Choose minimal free resolutions $F \to Y$ and $G \to Y^\vee$, where $( - )^{\vee} = \Hom_E( - , E)$. Since $E$ is Gorenstein, dualizing is exact, and so the dual map $Y^{\vee \vee} \to G^\vee$ is a quasi-isomorphism. Since every finitely generated $E$-module is maximal Cohen-Macaulay, there is a natural isomorphism $Y \xra{\cong} Y^{\vee \vee}$. Composing, we arrive at a quasi-isomorphism
$$
F \to Y \xra{\cong} Y^{\vee \vee} \to G^{\vee}. 
$$
The mapping cone of this quasi-isomorphism is called a (minimal) \emph{complete resolution} of $Y$. We define $C(Y)$ to be this minimal complete resolution.

Set $T_{\on{st}} = C \circ \overline{\RR}_{\on{st}}$. When $\F \in \on{coh}(\PP^n)$, we call $T_{\on{st}}(\F)$ the \emph{Tate resolution of $\F$}. Here again, the subscript ``st" stands for ``standard" and is meant to distinguish this original definition of the Tate resolution from the toric Tate resolutions we discuss later on. 

\begin{example}
\label{tateex}
Let $\F \in \on{coh}(\PP^n)$; we apply the above description of the functor $C$ to compute $T_{\on{st}} (\F)$. Choose an $S$-module $M$ such that $\widetilde{M} = \F$, let $r = \on{reg}(\F)$, and denote by $M_{\ge r}$ the $S$-module $\bigoplus_{j \ge r} M_j$. We observe that $\overline{\RR}_{\on{st}}(\F)$ is the image of $\RR(M_{\ge r})$ in $\on{D}_{\on{sing}}(E)$, so $T_{\on{st}} (\F) = C(\RR(M_{\ge r}))$. Since $\RR(M_{\ge r})^\vee$ is itself a minimal free resolution, we take $G = \RR(M_{\ge r})^\vee$. On the other hand, $\RR(M_{\ge r})$ is typically not bounded below, so one cannot immediately take its minimal free resolution; we first have to choose a bounded complex to which $\RR(M_{\ge r})$ is quasi-isomorphic, and then we choose $F$ to be the minimal free resolution of this bounded object. By \cite[Corollary 2.4]{EFS}, $\RR(M_{\ge r})$ is an injective resolution of the kernel $K$ of the differential $\RR(M_{\ge r})_{-r} \to \RR(M_{\ge r})_{-r -1}$, so we take $F$ to be the minimal free resolution of $K$. There is a canonical quasi-isomorphism $F \to \RR(M_{\ge r})$, and $T_{\on{st}} (\F)$ is its mapping cone.
\end{example}


One of the main results of Eisenbud-Fl\o ystad-Schreyer in \cite{EFS} is that one can read off the cohomology of $\F(\l)$ for all $\l$ from the ranks of the terms of $T(\F)$:

\begin{thm}[\cite{EFS} Corollary 4.2]
\label{EFS}
For all $j, \l \in \Z$, $H^j(\PP^n, \F(\l)) = \Hom_E(K, T_{\on{st}} ^{j + \l})_{-\l}$.
\end{thm}
Theorem \ref{EFS} leads to an algorithm for computing sheaf cohomology over $\PP^n$ which is, in some cases, the fastest available. One of the main goals of this article is to generalize the Tate resolution, and Theorem \ref{EFS}, from $\PP^n$ to any projective toric variety \michael{or stack?}. We conclude this section with an alternative construction of the Tate resolution over $\PP^n$ that more easily generalizes to toric varieties. This alternative construction also clarifies the relationship between the Tate resolution, sheaf cohomology, and Beilinson's resolution of the diagonal. 

The idea is to define the Tate resolution via a Fourier-Mukai-type functor
$$
\Phi_{\tR}: \on{coh}(\PP^n) \to K^{\on{ex}}(E).
$$
We define our ``kernel" $\tR$ to be the exact complex 
$$
\cdots \from \OO(1) \otimes_k \om(-1) \from \OO \otimes_k \om \from \OO(-1) \otimes_k \om(1) \from \cdots
$$
with differential $\sum_{i = 0}^n x_i \otimes e_i$. Loosely speaking, we think of $\tR$ as a complex of sheaves on ``$\PP^n \times E$"; we will define $\Phi_{\tR}(\F)$ by ``pulling $\F$ back to $E$, tensoring with $\tR$, and pushing forward to $E$." \michael{I'm resisting going too far with the Fourier-Mukai metaphor here, because I don't know what sort of category the object $\tR$ should really live in. Since it's exact, we certainly don't want it to live in an ordinary derived category. Probably something more like a singularity category, but involving both $\PP^n$ and $E$. I don't quite see it. It would probably be helpful to comment on this.}

\begin{rem} \michael{This needs to be polished.}
Some motivation for the definition of $\tR$ is in order. We recall from \cite[Section 6]{EFS} that there is a functor
\begin{equation}
\label{geobgg}
\Omega: \Com_{\on{Free}}(E) \to \Com(\PP^n)
\end{equation}
from complexes of free $\Z$-graded $E$-modules to complexes of sheaves on $\PP^n$ such that
$$
H_i(\Omega \circ T_{\on{st}} )(\F) = \begin{cases} \F & i = 0 \\ 0 & i \ne 0. \end{cases}
$$
We briefly explain the definition of $\Omega$. By \cite[Proposition 5.6]{EFS}, there is a canonical map
\begin{equation}
\label{mapid}
\Hom_E(\om(i), \om(j)) \to \Hom_{\PP^n}(\Omega^i(i), \Omega^j(j))
\end{equation}
for all $i, j$. Noting that any free $E$-module can be written as a direct sum of twists of $\om$, define $\Omega$ by 
replacing each summand $\om(j)$ of an object in $\Com_{\on{Free}}(E)$ with $\Omega^j(j)$ and by using (\ref{mapid}) to give the differentials (this explains the choice of notation for the module $\om$). 

Now, let $\cR$ denote Beilinson's resolution of the diagonal over $\PP^n$ (\cite{beilinson}); we recall that $\cR$ is the Koszul complex
$$
0 \from \OO \boxtimes \OO \from \cdots \from \OO(-n + 1) \boxtimes \Omega^{n-1}(n-1) \from \OO(-n) \boxtimes \Omega^n(n) \from 0
$$
of the section $\sum_{i = 0}^n x_i \boxtimes \frac{\partial}{\partial y_i} \in H^0(\PP^n \times \PP^n, \OO(1) \boxtimes T(-1))$, where the $x_i$ and $y_i$ are the coordinates of the first and second copies $\PP^n$, respectively. The intuition for the definition of $\tR$ is that, if we apply the functor $\Omega$ to the factors $\om(i)$ appearing in $\tR$ and to the maps given by contraction by $\frac{\partial}{\partial y_i}$, we get $\cR$. \michael{This still doesn't fully motivate the definition of $\Phi_{\tR}$. What I want to say is something like: $\Omega$ determines an equivalence $K^{\on{ex}}(E) \to \Db(\PP^n)$, and $\Omega \circ \Phi_{\tR} = \Phi_{\cR}$. Therefore, since $\Phi_{\cR}$ is isomorphic to the identity, $\Phi_{\tR}$ is an inverse of $\Omega$; in particular, it is an equivalence $\Db(\PP^n) \to K^{\on{ex}}(E)$, just like the Tate resolution functor. I'm not sure this is the right way to explain this. Need to think more about this. Also, it would be nice to have one diagram relating the Tate resolution, the resolution of the diagonal, and the functor $\RR$. Really want to completely clarify the relationship between the Beilinson, BGG, and EFS papers in this section.}
\end{rem}
 

We now give the precise definition of $\Phi_{\tR}$. Let $\F \in \on{coh}(\PP^n)$. We take a \v{C}ech resolution of the complex
$$
\cdots \from \F(1) \otimes_k \om(-1) \from \F \otimes_k \om \from \F(-1) \otimes_k \om(1) \from \cdots
$$
of sheaves on $\PP^n$ associated to the usual open cover, giving the bicomplex
$$
\xymatrix{
\cdots & \fC^0_{\F(1)} \otimes_k \om(-1) \ar[l]\ar[d]  & \fC^0_{\F} \otimes_k \om \ar[l] \ar[d] & \fC^0_{\F(-1)} \otimes_k \om(1) \ar[l] \ar[d] & \ar[l]  \cdots\\
\cdots  & \fC^1_{\F(1)} \otimes_k \om(-1) \ar[l] \ar[d] & \fC^1_{\F} \otimes_k \om \ar[l] \ar[d]  & \fC^1_{\F(-1)} \otimes_k \om(1) \ar[l] \ar[d] & \ar[l] \cdots \\
& \vdots & \vdots  & \vdots &\\
}
$$
with $(p, q)$ term $\fC^{-p}_\F \otimes \om(q)$ and with horizontal differentials given by multiplication by $\sum_{i = 0}^n x_i \otimes e_i$. Denote this $E$-linear bicomplex by $\B$. 

\begin{lemma}
\label{splitting}
The totalization of $\B$ is homotopy equivalent to a minimal exact complex $F$ with $m^{\th}$ term $\bigoplus_{q - p = m} H^p(\PP^n,\F(-q)) \otimes_k \om(q)$. When $m \le -\on{reg}(\F) - n$, $F_m = H^0(\PP^n,\F(-m)) \otimes_k \om(m)$, and the differential in these degrees is given by multiplication by $\sum_{i = 0}^n x_i \otimes e_i$.
\end{lemma}

\begin{proof}
Since $\B$ is bounded and its rows are exact, $\on{Tot}(\B)$ is exact. The columns of $\B$ split $E$-linearly, and its vertical homology in position $(p, q)$ is $H^p(\PP^n,\F(-q)) \otimes_k \om(q)$; the rest follows from \cite[Lemma 3.5]{EFS}.
\end{proof}

We define $\Phi_{\tR}(\F) \in K^{\on{ex}}$ to be a minimal complex as in Lemma \ref{splitting}. 

\begin{thm}
\label{comparison1}
For any $\F \in \on{coh}(\PP^n)$, there is an isomorphism $T_{\on{st}} (\F) \xra{\cong} \Phi_{\tR}(\F)$ of complexes of $E$-modules.
\end{thm}

\begin{proof}
It is immediate from Lemma \ref{splitting} and the construction of the Tate resolution in Example \ref{tateex} that $T(\F)$ coincides with $\Phi_{\tR}(\F)$ in degrees $\le -\on{reg}(\F) - n$. The result therefore follows from the uniqueness of minimal free resolutions. 
\end{proof}

\begin{rem}
Eisenbud-Fl\o ystad-Schreyer's calculation of sheaf cohomology over $\PP^n$ in terms of the ranks of the terms in the Tate resolution (Theorem \ref{EFS} above) is an immediate consequence of Theorem \ref{comparison1}. 
\end{rem}

%%%%%%%%%%%%%%%%
\section{Toric Tate resolutions}
%%%%%%%%%%%%%%%%
Let $k$ be a field, $N$ a finitely generated free abelian group, and $\Sigma$ a rational fan inside $N \otimes_\Z \Q$. We may associate to $\Sigma$ a toric \emph{variety} $X$ over $k$ and a toric \emph{stack} $\X$ over $k$. We briefly recall the constructions from \cite{cox} and \cite[Section 3]{BCS}, respectively. Let $\Sigma(1) = \{\rho_0, \dots \rho_n\}$ denote the rays of $\Sigma$, and let
$$
S = k[x_i \text{ : } \rho_i \in \Sigma(1)]
$$
denote the \emph{Cox ring} of $\Sigma$. The \emph{irrelevant ideal} of $\Sigma$ is the ideal 
$$
B_\Sigma = ( \prod_{\rho_i \nsubseteq \sigma} x_i \text{ : } \sigma \in \Sigma )
$$ 
of $S$. The variety $Z = \Spec(S) \setminus V(B_\Sigma)$ may be equipped with an action of a group $G$ associated to $\Sigma$. \michael{Fill in the description of $G$. It's $\Hom_\Z(A_{n-1}(X), k^*)$, but Borisov-Chen-Smith describe it without referring to $X$, which is better in this setting}. The categorical quotient of $Z$ by $G$ exists, and this is the toric variety $X$. We note that $S$ is $\Cl(X)$-graded. The toric stack $\X$ is the quotient stack $[Z/G]$. The stack $\X$ is Deligne-Mumford if and only if the fan $\Sigma$ is simplicial, and the natural map $\X \to X$ exhibits $X$ as the coarse moduli scheme of $\X$. Note that, when $X$ is smooth, $\X = X$.

Let $E = \Lambda_k(e_i \text{ : } \rho_i \in \Sigma(1))$, equipped with the $\Cl(X) \times \Z$-grading given by $|e_i | = (-|x_i|, -1)$. Our goal in this section is to prove the following

\begin{thm}
There is a functor
$$
T : \on{Qcoh}(\X) \to \DM(E)
$$
such that $T(\F)$ is exact, and...\michael{sheaf cohomology calculation.}
\end{thm}

Given $\F \in \on{Qcoh}(\X)$, we call $T(\F)$ the \emph{Tate resolution} of $\F$. 


The idea is to generalize the Fourier-Mukai construction of the Tate resolution over $\PP^n$ introduced in Section \ref{FM}. Our ``kernel" in this case is the differential $\OO_\X$-module
$$
\tR_{\DM} = (\bigoplus_{a \in \Cl(X)} \OO_\X (a) \otimes_k \om(-a, 0), \sum_{i = 0}^n x_i \otimes e_i).
$$
\michael{I guess we should introduce differential modules over ringed spaces rather than just rings, but that seems sort of pedantic.} When $\X = \PP^n$, $\tR_{\DM} = \Fold(\tR)$, where $\tR$ is as in Section \ref{FM}. Let $\F \in \on{Qcoh}(\X)$. Just as in Section \ref{FM}, the idea is to think of $\tR_{\DM}$ as a differential module over ``$\X \times E$'' and define $T_{\on{toric}}(\F)$ by ``pulling $\F$ back to $\X \times E$, tensoring with $\tR_{\DM}$, and pushing forward to $E$". 

Let us now define the functor $T_{\on{toric}}$. We recall that there is an equivalence of categories $\on{Qcoh}(\X) \simeq \on{Qcoh}_G(Z)$, where the right-hand side denotes the category of $G$-equivariant quasi-coherent sheaves on the variety $Z$. Let $\fU$ denote the $G$-invariant affine open cover of $Z$, indexed by the cones of maximal dimension in $\Sigma$, described in \cite[Proposition 4.3]{BCS}. Let $\F \in \on{Qcoh}(\X)$, and let $\fC_\F$ denote the \v{C}ech complex of $\F$ associated to $\fU$. We have a bicomplex
$$
\xymatrix{
\cdots &  \bigoplus_{a \in \Cl(X)} \fC^0_{\F(a)} \otimes_k \om(-a, -1) \ar[l]\ar[d]  & \bigoplus_{a \in \Cl(X)} \fC^0_{\F(a)} \otimes_k \om(-a, 0) \ar[l] \ar[d] & \ar[l]  \cdots\\
\cdots  &\bigoplus_{a \in \Cl(X)} \fC^1_{\F(a)} \otimes_k \om(-a, -1) \ar[l] \ar[d] & \bigoplus_{a \in \Cl(X)} \fC^1_{\F(a)} \otimes_k \om(-a, 0) \ar[l] \ar[d]  & \ar[l] \cdots \\
& \vdots & \vdots  &\\
}
$$
with $(p, q)$ term $ \bigoplus_{a \in \Cl(X)} \fC^{-p}_{\F(a)} \otimes_k \om(-a, q)$, vertical differentials given by direct sums of \v{C}ech differentials, and horizontal differentials given by multiplication by $\sum_{i = 0}^n x_i \otimes e_i$. Denote this $E$-linear bicomplex by $\B_{\on{per}}$. Notice that $\on{Tot}(\B_{\on{per}}) \in \Comper(E, (0,-1)),$ and so it corresponds via the equivalence $\on{Ex}$ to an object in $Y \in \DM(E)$. 

\begin{lemma}
\label{splitting2}
The differential module $Y$ is homotopy equivalent to a minimal exact differential module with underlying $E$-module
$$
\bigoplus_{i \in \Z} \bigoplus_{a \in \Cl(X)} H^i(\X, \F(a)) \otimes_k \om(-a, i).
$$
\end{lemma} 

\begin{proof}
Same as the proof of Lemma \ref{splitting}.
\end{proof}

Now define $T$ (up to homotopy equivalence).

\begin{rem}
When $X = \PP^n$ (in which case $\X = \PP^n$), we have an isomorphism
$$
T(\F) \cong \Fold(T_{\on{st}}(\F)).
$$ 
\end{rem}


\begin{example}
\michael{Work this example in somehow.}Let's work on $\PP^1$.  Let $\mathcal D:= \cO_{\PP^1}\oplus \cO_{\PP^1}^2(-1) \oplus \cO_{\PP^1}(-2)$ with the Koszul differential on $\mathcal D$, so that $\mathcal D$ is exact.  Let $C^0\to C^1$ be the Cech resolution of $\mathcal D$. Under the construction above, we end up with a total complex
$
\cdots \overset{\partial}{\longrightarrow} G \overset{\partial}{\longrightarrow} G \overset{\partial}{\longrightarrow}G \overset{\partial}{\longrightarrow} \cdots
$
where
\[
G\cong H^0(\PP^1,\cO) \oplus H^1(\PP^1,\cO(-2)).
\]
While $G$ is isomorphic to the total cohomology of $C^\bullet$, note that the $H^0$ and $H^1$ come from different copies of $C^\bullet$ in the total complex.  Namely, if we are looking at the copy of $G$ in position $0$, then the $H^0$ is the $0$'th homology of the $C^\bullet$ in column $0$ whereas the $H^1$ part is the $1$'st homology of $C^\bullet$ in column $1$.  That is to say, if we write $C^\bullet_i$ for the Cech complex in column $i$, and we write $G_i$ for the copy of $G$ in position $i$, then:
\[
G_i = \HH^0(C^\bullet_i)\oplus  \HH^1(C^\bullet_{i+1}).
\]
So to get the map $H^1\to H^0$ we would require at least $3$ copies of the Cech complex.  This explains why we can't just define the differential as ``the pushforward of the map $\partial$''.
\end{example}




\section{Tate modules}
Let $X$ be a projective toric variety and let $\cE$ be a coherent sheaf on $X$.  Our main result is a proof that, over the exterior dual of the Cox ring of $X$, there exists a free differential module $\Tate(\cE)$ which combines all of the sheaf cohomology groups of $\cE$ into a single exact differential module.  
%Throughout, we will write $\widehat{\cE}:= \oplus_{d\in \Pic(X)}\cE(d)$.
%\daniel{Seems to work for any toric variety at all, though we need $V(x_1,\dots,x_n)$ to be the empty set for it to be exact..}  

%exist there exisWe will define the Tate modules as a pushforward in a category of differential modules.  This perspective provides additional flexibility, allowing us to easily construct ``Tate modules'' in contexts--like with toric varieties--where we know that the categories of complexes/resolutions is insufficient.  Moreover, the framework helps clarify some of the sbutle exactness properties satisfied by these differential modules.

\begin{thm}\label{thm:toric exact}
Let $X$ be a simplicial toric variety and let $\cE$ be a coherent sheaf on $X$.  There exists a free, exact differential module $(\Tate(\cE), \del)$ whose underlying module is:
\[
\Tate(\cE) = \bigoplus_{i=0}^{\dim X} \bigoplus_{\ell \in \Pic(X)} H^i(X,\cE(-\ell)) \otimes_k \omega_E(\ell;-i).
\]
\end{thm}
The key idea in the proof is to realize $\Tate(\cE)$ by developing a theory of pushforwards for differential $\cO_X$-modules.  The following push-pull diagram summarizes our definition of the Tate module:
%\[
%\xymatrix{
%\Coh_{\free}(X_E)\ar[r]^{\kappa^*}&\DM_{\free}(X_E)\ar[d]_{\pi_{2*}}\\
%\Coh(X)\ar[r]^-{\Tate}\ar[u]^{\pi_1^*}&\DM^\circ(E)
%}
%\]
%For $\pi_1^*$
%

\[
\xymatrix{
\Coh(X)\ar[rr]^{\kappa^*}\ar[rrd]^-{\mathbf T}&&\DM_{\free}(X_E)\ar[d]_{\tau_*}\\
&&\DM^\circ(E)
}
\]
The arrow $\kappa^*$ sends the sheaf $\cE$ to the Koszul complex of $\widehat{\cE}$ with respect to the variables $x_0, x_1, \dots, x_n$, which can naturally be understood as a differential $\cO_{X_E}$-module.  The vertical arrow $\tau_*$ is the natural (derived) pushforward functor for these categories of differential modules.  So in essence, as with an integral transform, we are pulling back $\cE$ to $X_E$; then  tensoring with the Koszul complex; then pushing forward.  

This process recovers the known Tate resolutions on projective space and on products of projective spaces (see Example~\ref{ex:compare with PPn} for the precise statement), but via a very different approach.  More importantly, this definition allows us to highlight subtle exactness properties of these Tate modules, which are controlled by the irrelevant ideal of $S$.  

We prove two other key results in this section.  Theorem~\ref{thm:exactness properties} shows that the Tate module satisfies even stronger exactness properties, which are encoded by the irrelevant ideal of $X$.  Theorem~\ref{thm:alg characterization} gives an algebraic characterization of the Tate module, which is more closely related to the approach of~\cites{EFS,EES}.

\medskip 
We start making this precise.  Let $\Mod(X_E)$ denote the category of $\cO_X\otimes_k E$-modules which are graded with respect to the $E$-grading.  We let $\DM(X_E)$ be the category of differential $\cO_X\otimes_k E$-modules which have degree $(0;1)$ in the $\Pic(X)\oplus \ZZ$ grading on $E$.\footnote{We could also consider differential modules of degree $d$ for any $d\in \Pic(X)\oplus \ZZ$, but degree $(0;1)$ is the only one we will require.} We first observe that the Koszul complex of $x_1, \dots, x_n$ is naturally an object in $\DM(X_E)$.  To get the grading right, we start with the $\cO_X\otimes_k E$ module:
\[
\oplus_{d\in \Pic(X)} \cO_X(d) \otimes_k \omega_E(-d;0).
\]
and we endow this with the differential given by $\sum_{i=1}^n x_i\otimes e_i$.  We refer to this differential $\cO_{X}\otimes_k E$-module as $\Kos$.  In a similar way, for any subset $I\subseteq \{1,\dots,n\}$, we can endow the same underlying module with the differential $\sum_{i\in I} x_i\otimes e_i$.  We refer to this as $\Kos_I$.  There is a natural quotient
$
\Kos\to \Kos_I
$
obtained by sending $e_i\mapsto 0$ for $i\notin I$.  \daniel{Check this.}

\begin{defn}
We define $\kappa^*: \Coh(X) \to \DM(X_E)$ as the composition of functors:
\[
\xymatrix{
\Mod(X) \ar@/^2pc/[rr]^{\kappa^*}\ar[r]^{\otimes_k E}&\Mod(X_E)\ar[r]^{\otimes \Kos}&\DM(X_E)\\
\cE\ar@{|->}[r]&\cE\otimes_k E \ar@{|->}[r]&(\cE\otimes_k E)\otimes \Kos
}.
\]
We define $\kappa_I^*$ similarly, but tensoring by $\Kos_I$ in the second step.
\end{defn}
\begin{remark}
We can think of $\kappa^*\cE$ in more concrete terms as follows.  The underlying module of $\kappa^*\cE$ is $\oplus_{d\in \Pic(X)} \cE(d)\otimes_k \omega_E(-d;0)$ and the differential is multiplication by $\sum_{i=1}^n x_i\otimes e_i$.
\end{remark}


Theorem~\ref{thm:toric exact} will follow easily once we have constructed the pushforward functor $\tau_*$, which sends exact differential modules to exact differential modules.  This functor also determines a functor on the underlying submodules $\tau^{\Mod}_*: \Mod(X_E)\to \Mod(E)$ and such a functor is in term determined by its effect on objects of the form $\cE\otimes_k \omega_E(d;j)$. 
In our case, this functor will essentially send a sheaf to its sheaf cohomology, with appropriate $E$-gradings:
\[
\tau^{\Mod}_*: \cE\otimes_k \omega_E(d;j) \mapsto \oplus_{i=0}^{\dim X}H^i(X,\cE) \otimes_k E(d; j-i).
\]
The details involve homological perturbation applied to complexes of the form $C^\bullet\otimes_k E$, where $C^\bullet$ is the Cech complex of a sheaf on $X$, and these will be covered in \S\ref{sec:tau}.  However, the main result that we need is captured by the following proposition:


\begin{prop}\label{prop:main tau}
There is an additive functor $\tau_*$ from $\DM(X_E)$ to the homotopy category of $\DM(E)$, which preserves exactness and where the induced functor $\tau^{\Mod}_*\colon \Mod(X_E)\to \Mod(E)$ on underlying modules is determined by
%\[
%\tau^{\Mod}_*\colon \Mod(X_E)\to \Mod(E)
%\]
%is determined by
\[
\cE\otimes_k \omega_E(d;j) \mapsto \oplus_{i=0}^{\dim X}H^i(X,\cE_\ell) \otimes_k E(d; j-i). 
\]
%\tau_*\mathcal D$ satisfies: If $|\mathcal D| =\oplus_{\ell\in \Pic(X)} \cE_\ell\otimes_k E(\ell;0)$ then
%	\begin{equation}\label{eqn:underlying module}
%	 |\tau_*\mathcal D| =\bigoplus_{i=0}^{\dim X}\bigoplus_{\ell\in \Pic(X)} H^i(\cE_\ell)\otimes_k E(\ell;-i).
%	 \end{equation}
%
\end{prop}
We postpone the proof until \S\ref{sec:tau}, but note that it immediately implies Theorem~\ref{thm:toric exact}.

\begin{defn}
We define $(\Tate(\cE),\partial)$ as the differential $E$-module $\tau_*\kappa^*(\cE\otimes \mathcal K)$.  For any $I\subseteq \{1,2,\dots,n\}$, we define $(\Tate(\cE),\partial_I)$ as the differential $E$-module $\tau_*\kappa^*(\cE\otimes \mathcal K)$
\end{defn}

\begin{proof}[Proof of Theorem~\ref{thm:toric exact}]
The homology of $\Kos$ is supported on $V(x_1,\dots,x_n)$ which is the empty set.  It follows that the same statement holds for $\kappa^*\cE$.  In other words, $\kappa^*\cE$ is exact.  Thus $\tau_*\kappa^*\cE=\Tate(\cE)$ is exact.  Proposition~\ref{prop:main tau} confirms that the underlying module of $\tau_*\kappa^*\cE$ is as stated.
\end{proof}

We next observe that when $X=\PP^n$ this recovers the Tate resolution of~\cite{EFS}.
\begin{example}\label{ex:compare with PPn}
%Let $X=\PP^n$ and let $\cE$ be a $0$-regular sheaf on $\PP^n$.  Let $M=\oplus_{d\geq 0} H^0(\PP^n,\cE(d))$ be the corresponding $0$-regular $S$-module.  
Let $X=\PP^n$ and let $\cE$ be a coherent sheaf on $\PP^n$.  Let $M$ be a graded $S$-module such that $\widetilde{M}=\cE$. Let $\Tate' \cE$ denote the differential module obtained from the Tate resolution as defined in~\cite{EFS}.  By Remark~\ref{rmk:PPn DM is complexes}, it suffices to show that $\Tate'\cE$ is isomorphic to the Tate module $\Tate \cE=\tau_*\kappa^*\cE$ as defined as above. For starters, both Tate resolutions agree with $\RR M$ in degrees $\geq d$ for some $d$.  Write $T$ for the tail of $\tau_*\kappa^*\cE\to \RR M_{\geq d}$ and $T'$ for the tail of $\Tate'\cE\to \RR M_{\geq d}$.  Then $T$ and $T'$ are both minimal free resolutions of the differential module $\RR M_{\geq d}$ and thus they are isomorphic by the uniqueness of minimal free resolutions of differential modules.  
\daniel{Need to add reference to the equivalence between $\DM(E)$ and $\Com(E)$ in this case.}
\end{example}

\subsection{Exactness properties of $\Tate(\cE)$}
Using nearly identical methods reveals deeper exactness properties of these Tate resolutions.
\begin{defn}\label{defn:irr and primitive}
Given $I\subseteq \{0,1,\dots,n\}$, we say that $I$ is {\bf irrelevant} if the ideal $\langle x_i \text{ where } i\in I\rangle$ contains the irrelevant ideal.  Following Batyryev (see~\cite[p. 304]{CLS}), we say that $I$ is {\bf primitive} if it is irrelevant but if no proper subset of $I$ is irrelevant.
%Given a free complex $\bF$ of $S$-modules (resp.\ of $E$-modules), we will denote $\bF_I$ the free complex of $S$-modules obtained by setting $x_i=0$ for $i\in I$ (resp.\ setting $e_i=0$ for $i\in I$) in all of the differentials of $\bF$.
\end{defn}


%\begin{example}
%If $\bF = [S(-1)^1 \overset{x_0+x_1}{\longrightarrow} S^1]$ and $I=\{0\}$ then $\bF_I = [S(-1)^1 \overset{x_1}{\longrightarrow} S^1]$.  
%%This is the same thing as first quotienting $\bF\mapsto \bF/(x_0)$ and extending by the inclusion of polynomial rings $k[x_1] \subseteq k[x_0,x_1]$.
%\end{example}
One crucial feature of Tate resolutions over other toric varieties is that they satisfy more complicated exactness properties, which are encoded by the irrelevant ideal.
\begin{thm}[Exactness Properties]\label{thm:exactness properties}
If $I\subseteq \{0,1,\dots,n\}$ is irrelevant, then $(\Tate(\cE),\partial_I)$ is exact.
\end{thm}
\begin{proof}
The proof of Theorem~\ref{thm:toric exact} goes through almost verbatim.  The homology of $\Kos_I$ is supported on $P_I$.  But $I$ is irrelevant which implies that $\Kos_I$ is exact, which implies that $\kappa_I^*$ is exact, which implies that $\tau_*\kappa_I^*\cE$ is exact.
\end{proof}
These nuanced exactness properties were not present for the Tate resolutions in~\cite{EFS}: the irrelevant ideal equals the maximal ideal on projective space, so there are no interesting choices for $I$ in that case.  But for products of projective spaces, these exactness properties are equivalent to the the exact ``rows and columns'' which played a key role in~\cite{ees-products}.  

\subsection{Algebraic characterization of $\Tate(\cE)$}
The exactness properties lead to an algebraic characterization of $\Tate(\cE)$ as a differential module. 
The following theorem shows that, if $M$ is a multigraded $S$-module, then the Tate resolution of $\widetilde{M}$ can be determined by the algebraic data of: $\RR(M)$ and the exactness properties of Theorem~\ref{thm:exactness properties}.  This is something like a parallel of the fact that a toric variety may be determined by two pieces of algebraic data:  its multigraded Cox ring $S$ and its irrelevant ideal.   Namely, $\RR(M)$ is a differential module which is entirely determined by the Cox ring $S$, but passing from $\RR(M)$ to $\Tate(\widetilde{M})$ requires the exactness properties, which are determined by the irrelevant ideal. 
%% \daniel{I'd like to prove a statement like the following:}
%

%\subsection{Intrinsic characteristization of $\Tate(\cE)$}


\begin{thm}[Algebraic Characterization of $\Tate(\cE)$]\label{thm:alg characterization}
Up to isomorphism, $\Tate(\widetilde{M},\partial)$ is the unique minimal, free differential module which equals $\RR M_{\geq d}$ for all $d\gg 0$ and which satisfies the exactness properties of Theorem~\ref{thm:exactness properties}.
\end{thm}
\begin{remark}
This theorem quickly implies that the Tate resolutions of~\cite{EFS} and~\cite{EES} agree with the Tate modules constructed in this paper.
\end{remark}
The proof involves some facts about the minimal primes of the irrelevant ideal of $X$.

\begin{lemma}\label{lem:degI}
Let $\mu: \Pic(X)\to \ZZ$ be a linear functional such that $\mu\geq 0$ is one of the minimal defining halfspaces of $\Eff(X)$.  There exists a primitive subset $I\subseteq \{1,\dots,n\}$ such that $\mu( \deg x_i)>0$ for all $i\in I$.
\end{lemma}
\begin{proof}
The nef cone $\NE(X)$ belongs to the effective cone $\Eff(X)$, so the intersection of $\mu=0$ and $\NE(X)$ will lie inside of some (and possibly more than one) facet of $\NE(X)$.  Let $\tau: \Pic(X)\to \ZZ$ be the defining functional of that facet.  We thus have:
\[
\Eff(X) \setminus \{\mu=0\} \supseteq \NE(X) \setminus \{\tau = 0\}.
\]
 By~\cite[Proof of Theorem~6.4.11]{CLS} (see also the citations to Cox-von Resse and Kresch from CLS \dots), we conclude that the set $I$ of $i$ such that $\tau(\deg x_i)>0$ forms a primitive a collection.  It follows that $\mu(\deg x_i)> 0$ for each $i\in I$.  Namely, $\mu(\deg x_i)$ since $\deg x_i\in \Eff(X)$ and $\tau(\deg x_i)\ne 0 \Rightarrow \mu(\deg x_i)\ne 0$ by the displayed inclusion.
\end{proof}

%\begin{remark}\label{rmk:degI}
%The minimal primes of the irrelevant ideal of $X$ are in bijection with primitive collections by~\cite[find right citation]{CLS}.  Any primitive collection $I$ determines a unique functional
%\[
%\phi_I: \Pic(X)\to \ZZ
%\]
%where $\phi_I(\deg x_i)>0$ if and only if $i\in I$.  In the notation of ~\cite[Definition 6.4.10]{CLS}, this functional is $\phi_I(\deg x_{\rho}) = b_{\rho}$.  Moreoever, ~\cite[Theorem~6.4.11]{CLS}, implies that these functionals are in bijection with the minimal defining halfspaces of $\NE(X)$.   
%
%We will be interested in the defining halfspaces of $\Eff(X)$.  Let $\mu: \Pic(X)\to \ZZ$ be a linear functional such that $\mu\geq 0$ is one of the minimal defining halfspaces of $\Eff(X)$.  (In other words, $\mu$ corresponds to an extremal ray of $\Eff(X)^\vee$.)  Since $\NE(X) \supseteq \Eff(X)$, this implies that the half-space $\mu\geq 0$ contains $\NE(X)$.  This implies that the strict inequality $\mu>0$ contains some facet $\phi_I$ of $\NE(X)$.  The corresponding primitive collection $I$ thus satisfies $\mu(x_i)>0$ for $i\in I$.
%\end{remark}
%
\begin{example}
Consider the Hirzebruch surface $\mathbb F_3$ with Cox ring $S=k[x_0,x_1,x_2,x_3]$, irrelevant ideal $(x_0,x_2)\cap (x_1,x_3)$ and degrees of the variables $\deg(x_0)=\deg(x_2) = (1,0)$, $\deg(x_1)=(-3,1)$ and $\deg(x_3)=(0,1)$.  
The defining halfspaces of $\Eff(X)$ are determined are give $\mu_i\geq 0$ for $i=1,2$ where $\mu_i:\ZZ^2\to \ZZ$ is $\mu_1(a,b)=a+c$ and $\mu_2(a,b) = b$.  Note that $\mu_1$ is strictly positive on $x_0,x_2$ while $\mu_2$ is strictly positive on $x_1, x_3$.
\end{example}


\begin{proof}[Sketch of proof of Theorem~\ref{thm:alg characterization}]
Fix some $d\in \Pic(X)$ which is sufficiently large, in a sense to be made precise as we proceed.  Fix some facet $\Eff(X)$, defined by a functional $\mu:\Pic(X)\to \ZZ$ which is nonnegative on $\Eff(X)$.  By Lemma~\ref{lem:degI}, we can find a primitive collection $I\subseteq \{0,1,\dots,n\}$ where  $\mu(\deg x_i)$ is strictly positive for all $i\in I$.  

We use $\mu$ to flatten down to a $\ZZ$-grading on $E$.  Namely, we define $\deg_{\mu}(e_i) = -\mu(x_i)\in \ZZ$.  With respect to the $\deg_{\mu}$-grading,  we can apply Lemma~\ref{lem:ZZ to flag} to $(\Tate(\cE),\partial_I)$ to obtain:
%(\Tate(\cE),\partial_I)$ is a $\ZZ$-graded differential module whose differential is of purely negative degree.  By Lemma, this 
%This splits the free module $\Tate(\cE)$ as
\[
%\Tate(\cE) = \Tate(\cE)_{\leq_{\tau} \deg_{\tau}(d)}\oplus \Tate(\cE)_{>_{\tau} \deg_{\tau}(d)}=
(\Tate(\cE)^{\text{I-tail}},\partial_I) \to  (\Tate(\cE)^{\text{I-head}},\partial_I)
\]
where the $I$-head consists of all factors of the form $\omega_E(a;b)$ such that $\deg_{\mu}(a) \leq e$; the $I$-tail consists of all factors of the form $\omega_E(a;b)$ such that $\deg_{\mu}(a) > e$; and the differentials are the restrictions of $\partial_I$.

We next claim that: the $I$-tail of the Tate resolution, and the restriction of $\partial$ to this $I$-tail, can be recovered entirely from the $I$-head, its differential.

Since Lemma~\ref{lem:ZZ to flag} implies that the $I$-tail is the minimal free resolution of the $I$-head, the uniqueness of minimal free resolutions implies that we can recover the tail (and its differential $\partial_I$) entirely from the head.   This recovers the free module $\Tate(\cE)^{\text{I-tail}}$ as well as the part of the restriction of $\partial$ involving variables $e_i$ with $i\in I$.  We next claim that we can also recover the restriction of $\partial_I^C:=\partial - \partial_I$ to the tail from $\partial$ on the head.

%On $\Tate(\cE)$, we define $\partial_I^C:=\partial-\partial_I$.  
Since $\deg_{\mu}(x_i)\geq 0$ for all $1\leq i \leq n$, it follows that $\partial_I^C$ restricts to an endomorphism $\partial_I^C|_{\text{head}}$  of the $I$-head.  Since we have a map $(\Tate(\cE),\partial_I) \to (\Tate(\cE)^{\text{$I$-head}},\partial_I)$, we can apply Proposition~\ref{prop:lifting} to lift this to an endomorphism $(\Tate(\cE),\partial_I)$.  But by uniqueness of lifts, we see that any lift will agree with $\partial^C$, up to homotopy. We have thus recovered the entire Tate module $(\Tate(\cE),\partial)$ from $(\Tate(\cE)^{\text{$I$-head}},\partial)$, which is like ``half'' of the Tate module.

Now, we will iterate this argument, with two replacements.  We first replace the total Tate module $(\Tate(\cE),\partial)$ by the head half of the Tate module $(\Tate(\cE)^{\text{I-head}},\partial)$.  We then replace $\tau$ by another defining facet.  Iterating in this way ,we eventually conclude that, by using exactness properties, the full Tate module can be recovered entirely from the restriction of the Tate module to summands of the form $\omega_E(a;b)$ where $\deg_{\mu}(a)\geq \deg_{\mu}(d)$ for all functionals $\mu$ defining $\Eff(X)$.  We conclude that, using the exactness relations, the entire Tate resolution can be recovered from the Tate module in very positive degrees.  That is, $(\Tate(\cE)_{\geq d}, \partial)$ determines the entire Tate resolution, for any degree $d$.

Finally, we want to observe that all of the previous arguments go through with a global upper bound on the $\Pic(X)$-grading.  \daniel{I'm struggling to phrase this precisely, but I don't think there are any serious mathematical obstacles here.  Big idea:  everything of degree $\leq d'$ only depends on a finite window of degrees.  And for $d$ large enough, we can assume that for degrees between $d$ and $d'$, the Tate resolution agrees with $\RR M$.}  For a differential module $F$ over $E$ and degree $e \in \Pic(X)$ we will write $F_{(e;*)}$ for the differential module obtained by considering in the $(e;j)$ part of $F$, for all $j$.  Since we are working with a differential of degree $(0;1)$, this is a differential module of $k$-vector spaces.  And of course any differential module $F$ is entirely determined by its $(e:*)$-strands.

Moreover, since the elements of $E$ have $\Pic(X)$-degrees between $0$ and $w_E:= \sum_i \deg(x_i)$, we see that the strand $F_{(e;*)}$ only depends on summands of the form $\omega_E(a;j)$ where $e\geq a \geq e+w_E$. \daniel{Check the signs!!!} It follows that the degree $(e;*)$ strand of $F$ is determined by the subquotient of $F$ obtained by summing only over the free summands $\omega_E(-a;j)$ where $e\geq a \geq e+w_E$.

So if we write $F^{\leq d'}_{\geq d}$ for the natural subquotient of $F$ determined by restricting attention to summands of the form $\omega_E(a;j)$ where $d \leq -a \leq d'$, then $F^{\leq d'}_{\geq d}$ will have the same $(e;*)$-strand as $F$, as long as \daniel{some condition on $e,d,d'$ and $w_E$\dots}

In summary, the degree $(e;*)$ strands of $(\Tate(\cE),\partial)$ for $e\leq d'+w_E$ will be determined by the degree $(e;*)$ strands of $(\Tate(\cE)_{\geq d}^{\leq d'},\partial)$ for any $d$, as long as $d'-d\geq w_E$ (or something similar).  But for any finite window of degrees, like the window bewteen $d$ and $d+w_E$, we can choose $d\gg 0$ so that $\cE$ has no higher cohomology in this window, and in this case $(\Tate(\cE)_{\geq d}^{\leq d'},\partial)$ is just $(\RR M,\partial)_{\geq d}^{\leq d'}$.
%
%For $e\in \Pic(X)$ we will write $(\Tate(\cE)_{\geq d}, \partial)_{(e;*)}$ for the $k$-vector space of elements of degree $(e;j)\in \Pic(X)\oplus \ZZ$ for any $j$.  (In other words, we ignore the auxiliarly grading.)  Since $\partial$ has degree $(0;1)$, it restricts to a map on each such ``strand''.  So we choose $d'$ sufficiently larger than $d$ (I think $d$ plus the canonical degree will suffice), and write $\Tate(\cE)_{\geq d}^{\leq d'}$ for the subquotient of $\Tate(\cE)$ obtained by restricting to summands of the form $\omega(a;j)$ with $d\leq a \leq d'$.  Then, for every $d\leq e \leq d'$, the degree $(e;*)$-strands of $(\Tate(\cE)_{\geq d}^{\leq d'},\partial)$ are the same as for $(\Tate(\cE)_{\geq d}, \partial)$.  And so, running the same arguments as above, we can recover $(\Tate(\cE)^{\leq d'},\partial)$ from $(\Tate(\cE)_{\geq d}^{\leq d'},\partial)$.  Now, if we choose $d$ and $d'$ to be sufficiently ample, then $(\Tate(\cE)_{\geq d}^{\leq d'},\partial)$ will agree with $\RR M$ in those degrees, and so we see that we can recover everything from the $\RR M$ in high degrees.

%Since elements in $E$ have bounded degree in the $\Pic(X)$, the degree $(e;*)$-strand of $(\Tate(\cE)_{\geq d}, \partial)$ only involves 
%
%
%
%If we choose $d$ and $d'$ sufficiently positive, then for every degree $e$ between $d$ and $d'$ (plus or minus the canonical degree), $(\Tate(\cE)_{\geq d}, \partial)_{(e;*)}$ will be the same as $(\RR M,\del)_{(e;*)}$
%
%
%
%It suffices to do this Let's say that we want to recover
%
%can be recovered
%\daniel{This last step needs some thought.}  Finally, we want to show that the entire previous argument can be applied after restricting everything to degree $\leq d'$ for some $d' \gg d$.  \daniel{This should probably be done earlier.}  Then we take the direct limit as $d'\to \infty$.
%
%\daniel{For the very last step, we might need a limit?  Or to work with a window?  When the effective cone and the nef cone differ, $\RR(M_{\geq d})$ doesn't equal $\Tate(\cE)_{\geq d}$.  But if we focus degrees in a window between say $d$ and $d'$, then I think everything works.  But this is a bit delicate.} 

%
%for each primary component of the irrelevant ideal, there is some copy of $\ZZ$ in $\Pic(X)$ where the corresponding variables are all strictly positive. Let's consider the case where $\Pic(X)=\ZZ^3$.  After changing potentially changing basis on $\ZZ^3$, we can assume that for some primary component $P_I$ of the irrelevant ideal, the variables $x_i$ with $i\in I$ all satisfy $\deg(x_i) = (d_1,d_2,d_3)$ where $d_1>0$.  Then,  we consider the factorization $\Tate_I(\cE)$ as 
%\[
%\Tate_I(\cE)_{<d_1,*} \to \Tate_I(\cE)_{\geq d_1,*}
%\]
%with differential $\partial_I$ for some $d_1 \gg 0$.  The first factor of $\Pic(X)$ gives a flag structure on $\Tate_I(\cE)_{<d_1,*}$, and so in the above diagram, the tail is the minimal free resolution of the head.  In particular, $\Tate_I(\cE)_{<d_1,*}$ is determined by $\Tate_I(\cE)_{\geq d_1,*}$.  But that only determines part of the differential, namely the part involving the variables from $I$.  However, the complementary part of the differential $\partial_I^C :=\partial - \partial_I$ induces a map of the above differential modules.  By the lifting lemma, $\partial_I^C$ on the rigth determines the $\partial_I^C$ on the left, up to homotopy.  So in short, using the exactness property for $I$, we see that half of the full Tate resolution is determined by the other half, at least up to homotopy.
%
%Now we select an $I'$ where the corresponding variables all have positive degree for the second copy of $\ZZ$ in $\Pic(X)$.  By a similar argument we see that
%\[
%\Tate_{I'}(\cE)_{\geq d_1, <d_2, *} \to \Tate_{I'}(\cE)_{\geq d_1, \geq d_2, *}
%\]
%we see that the full Tate resolution can be recovered by a quarter of the Tate resolution, i.e. by $\Tate(\cE)_{\geq d_1, \geq d_2, *}$. Iterating one more time, we see that $\Tate(\cE)$ can actually be totally recovered by $\Tate(\cE)_{\geq d_1, \geq d_2, \geq d_3}$.  Write $d=(d_1,d_2,d_3)$.  We can have chosen $d =(d_1,d_2,d_3)$ so that $ \Tate(\cE)_{\geq d} = \RR(M_{\geq d})$.  So we see that $\Tate(\cE)$ can actually be determined by exactness properties and by any sufficiently high degree part of $\RR M$.
%
\end{proof}
\begin{remark}
Running this argument in reverse gives a sketch of an algorithm for computing Tate resolutions, which would largely parallel the algorithm of~\cite{EFS} and \cite{eisenbud-decker}.  There are some delicate issues to address, though, as any algorithm would only work with finite windows of $\RR(M_{\geq d})$, and so one would need to understand how such truncations affect the process of computing minimal free resolutions, lifting endomorphisms, and more.
\end{remark}




\section{Applications}

\subsection{Toric Syzygy Theorem}

\

%\daniel{This may require that $X$ is simplicial.  So if we worked in greater generality earlier, then we need to restrict back here.}
\begin{defn}
We define the \defi{exterior irrelevant ideal} of $E$ as the ideal generated by monomials $e_{i_1}e_{i_2}\cdots e_{i_s}$ such that $x_{i_1}x_{i_2}\cdots x_{i_s}$ lies in the irrelevant ideal of $S$.
\end{defn}
\begin{thm}
Let $M$ be a finitely generated, graded $S$-module.  Then $M$ admits a virtual resolution of length at most $\dim X$.  More specifically, for any sufficiently ample degree $d\in \Pic(X)$, the projective dimension of $M_{\geq d}$ is at most $\dim X$.
\end{thm}
\begin{proof}
By applying Theorem~\ref{tor}(a) in the case $P=M_{\geq d}$, it will suffice to prove that the homology of $\RR M_{\geq d}$ lies in degrees $(a,j)$ with $-\dim X \leq j \leq 0$.    We let $(F,\del) = \RR M_{\geq d}$.  By the ``lift'' of an element $\alpha \in H(F,\del)$ we will mean an element of $F$, lying in the kernel of $\del$ and whose image in $H(F,\del)$ is $\alpha$.  Let $B\subseteq E$ be the exterior irrelevant ideal.  We will show that any lift of any element of $H(F,\del)$ lies inside $B\cdot F$.  

%First we choose $d_0$.  
By Theorem~\ref{tor}(a), the homology of $\RR M$ is supported in finitely many distinct degrees.
%  We choose $d_0\in \Pic(X)$ so that $d_0-a\geq 0$ for any of the finitely many degrees $(a,j)$ in the support of $H \RR M$. 
 It follows that, for any degree $e$ which is away form those finitely many degrees, the strand $(\RR M,\del)_{e,*}$ will exact.

Suppose that we choose some degree $d$ which is greater than all of the degrees $a$ where $(a,j)$ is in the support of $H\RR M$.  We consider $(\RR M_{\geq d}, \del)\to (\RR M,\del)$.  Let $\zeta$ be the lift of an element of $H (\RR M_{\geq d}, \del)$.  Since this is a map of differential modules, $\zeta$ maps to a cycle of $(\RR M,\del)$; but for degree reasons, this cannot be a homology element, and thus $\zeta$ lies in the image of $\del$.   More precisely, we can see that if $\omega=\sum_{i=1}^n \deg(x_i)$, then $\zeta$ must be a boundary of $(\RR M_{\geq d - \omega},\del)$.  

%We write $\omega_X:= \sum_{i=1}^n \deg(x_i)$.  
Now we choose $d$ to be sufficiently ample so that $\widetilde{M}$ has no higher cohomology in all degrees in the range between $d-\omega$ and $d$.  It follows that, for any degree $e$ in this range, and for any subset $I\subseteq \{1,\dots,n\}$: $(\RR M, \partial_I)_{e,*}$ equals $(\Tate \cE,\partial_I)_{e,*}$ and this has no higher cohomology.  (We use Theorem~\ref{thm:exactness properties} here.)

Recalling that $F=\RR M_{\geq d}$, we consider $(F, \del_I)$.  
%By definition, all summands of $F$ are of the form $\omega_E(-a;0)$ with $a\geq d$.  In particular, $F$ lives entirely in degrees $\geq (i;j)$ where $i\leq -d+\omega_X$ and $j\geq 0$. 
Let $\zeta$ be the lift of a homology element in some degree $(e,*)$ with $d-\omega \leq e \leq d$.  By the previous aparagraph, we know that $\zeta$ lies in the image of the differential $\partial_I$ on $(\RR M, \partial_I)$.  In particular, if $L_I = \langle e_i \text{ where } i\in I\rangle$, then $\zeta$ lies in $L_I \cdot F$.

Next we observe that the full differential $\del: F\to F$  is the sum of two differentials.  Since we have truncated in a very positive degree, we have $\del=\del_I + \del_{I^C}$ each of which is a differential by \daniel{We need to add this somewhere earlier, but it's purely formal.}  Using a spectral sequence argument \daniel{fill in}, we conclude that any lift of a homology element of $(F,\del)$ must also lie in $L_I\cdot F$.


Now, this has to hold for every minimal prime of the irrelevant ideal.  The intersection of $L_I$ over all such sets $I$ is, by definition essentially, our exterior irrelevant ideal.   It follows that the lift of any element of $H(F,\del)$ lies in $B\cdot F$, as claimed. 
Recall that $F$ is a direct sum of modules over the form $\omega_E(a;0)$, which is nonzero only in degree $(a,j)$ where  auxiliary degrees $-n \leq j \leq 0$.  By Lemma~\ref{lem:aux irr}, every element of $L_I$ is a product of at least $r$ variables.  We thus conclude that the homology of $(F,\del)$ lies entirely in degrees of the form $(a,j)$ with $-n+r\leq i \leq 0$.  Finally, we have that $\dim X = n-r$, completing the proof.
\end{proof}
\begin{lemma}\label{lem:aux irr}
Let $X$ be a projective simplicial toric variety and let $r=\rank \Pic(X)$.   Every minimal generator of the irrelevant ideal of $X$ is a product of $r$ distinct monomials.
\end{lemma}
\begin{proof}
The irrelevant ideal is generated by monomials corresponding to the product of the rays in the fan of $X$ that are complements to a max face~\cite[p. 207]{CLS}.  Since $r$ is the number of rays minus the dimension of the ambient lattice, it follows that each generator is a product of $r$ variables.
\end{proof}

\daniel{A remark:  Imagine we have fixed $S$ and $M$ but not $X$.  (In other words, imagine we have to toric varieities with the same cox ring $S$.  The choice of $d$ depends on $X$.  But the statement about the length of the minimal free resolution of $X$ does not.  In other words, all we seem to need is that $d$ is sufficiently ample for SOME $X$ whose Cox ring $S$.  This is a much less restrictive condition, which might be equivalent to being sufficiently far from the boundary of the effective cone.  But I'm not sure.}
















%%%%%%%%%%%%%
%%CUTTING BOARD%%
%%%%%%%%%%%%%
\iffalse
\section{Pushforward of differential modules}\label{sec:tau}
\daniel{This section is in rough shape.}
Here we give the explicit construction of the pushforward functor $\tau_*$.  We also prove results about a pushforward functor $\DM(X)\to \DM(k)$.
\begin{lemma}\label{lemma:tau}
Let $X$ be a toric variety over $k$ with Cox ring $S$, graded by $\Pic(X)$.  Let $E$ be the exterior algebra on the dual variables, with the $\Pic(X)\oplus \ZZ$-grading described above.
\begin{enumerate}
	\item There is an additive functor: $\pi_*\colon \DM(X)\to \DM^\circ (k)$ which preserves exactness and where $|\pi_* \mathcal D| =\oplus_{i=0}^{\dim X} H^i(X, |\mathcal D|)$, namely: the underlying module of $\pi_* \mathcal D$ is the total sheaf cohomology of the underlying module of $\mathcal D$.
%	and
%			\item  if $\mathcal D$ is exact, then so is $\pi_*\mathcal D$.
%		\end{enumerate}
	\item There is an additive functor: $\tau_*\colon \DM_{\free}(\PP^n_E)\to \DM^\circ(E)$ which preserves exactness and where the underlying module of $\tau_*\mathcal D$ satisfies: If $|\mathcal D| =\oplus_{\ell\in \Pic(X)} \cE_\ell\otimes_k E(\ell;0)$ then
	\begin{equation}\label{eqn:underlying module}
	 |\tau_*\mathcal D| =\bigoplus_{i=0}^{\dim X}\bigoplus_{\ell\in \Pic(X)} H^i(\cE_\ell)\otimes_k E(\ell;-i).
	 \end{equation}
	\end{enumerate}
\end{lemma}
\begin{proof}\daniel{Some notational bugs here.  I ran out of time but will fix soon.  All ideas correct.}
We first prove (1).  Start with a differential $X$-module whose underlying sheaf is $\cF$.  
By unfolding, we can realize this  in $\DD(\PP^n_E)$ as
\[
\cdots \overset{\partial}{\longrightarrow}\cF \overset{\partial}{\longrightarrow} \cF \overset{\partial}{\longrightarrow} \cF\overset{\partial}{\longrightarrow} \cdots
\]
Let $C^0\to C^1\to \cdots \to C^n$ be the Cech resolution for $\cF$, with $C^i$ an $S$-module.
We build a double complex $F^i_j$ where $F^i_j=C^i$ (in particular $F^i_j$ only depends on $j$); the columns are Cech resolutions and the horizontal maps are localizations of the differential $\partial$.

Each column of the double complex is the same, and taking vertical homology in the $i$'th spot gives $H^i(X,\cF)$. By choosing a splitting of $H^i(\cE_\ell)$ into the Cech complex for $\cF$, we get a splitting for the vertical homology in this double complex.  We can then apply~\cite[Lemma~3.5]{EFS}, to get a complex of $E$-modules:
\[
\cdots \overset{\partial}{\longrightarrow} G \overset{\partial}{\longrightarrow} G \overset{\partial}{\longrightarrow}G \overset{\partial}{\longrightarrow} \cdots
\]
where $G$ in column $0$ is
\[
G = \oplus_{i=0}^{\dim X} \HH^i(F^*_i) =  \oplus_{i=0}^{\dim X}H^i(\cF).
\]
A different splitting will induce the same complex, up to homotopy (since both would be homotopic to the original total complex, again by ~\cite[Lemma~3.5]{EFS}).  Applying Remark~\ref{rmk:cyclic} in reverse, $G$ induces a well-defined element of $\DM^\circ(k)$ as desired. 

Exactness is nearly immediate from the construction.  By construction, the $i$th homology of the complex
\[
\cdots \overset{\partial}{\longrightarrow}\pi_*\mathcal D\overset{\partial}{\longrightarrow}\pi_*\mathcal D\overset{\partial}{\longrightarrow}\pi_*\mathcal D\overset{\partial}{\longrightarrow} \cdots
\]
in $\DD(k)$ is the hypercohomology of the complex
\[
\cdots \overset{\partial}{\longrightarrow}\mathcal D\overset{\partial}{\longrightarrow}\mathcal D\overset{\partial}{\longrightarrow}\mathcal D\overset{\partial}{\longrightarrow} \cdots
\]
But by the standard hypercohomology spectral sequence $E^{i,j}_2=H^i (\HH^j -) \Rightarrow H^{i+j}(-)$, if (the unfolded complex for) $\mathcal D$ is exact then so is (the unfolded complex for) $\pi_*\mathcal D$.

The proof of (2) is nearly identical as the proof of (1), though we need to track the gradings in more detail.  Starting with an object $\cF := \oplus_{\ell} \cE_\ell\otimes_k E(\ell;0)$ from $\DM_{\free}(\PP^n_E)$, we get the unfolded complex:
\[
\cdots \overset{\partial}{\longrightarrow} \oplus_{\ell} \cE_\ell\otimes_k E(\ell;-1) \overset{\partial}{\longrightarrow} \oplus_{\ell} \cE_\ell\otimes_k E(\ell;0) \overset{\partial}{\longrightarrow} \oplus_{\ell} \cE_\ell\otimes_k E(\ell;1)\overset{\partial}{\longrightarrow} \cdots
\]
For each $\ell$, we take a separate Cech resolution of $\cE_\ell$, tensor with $-\otimes_k E(\ell; 0)$, and then take the direct sum of these to get one of our vertical columns, $C^*_0$.  We then let $C^*_i = C^*_0\otimes_E E(0;i)$.  We again build a double complex from these, where the columns are twists of Cech resolutions, and the horizontal maps are localizations of the differential $\partial$.

Each column is the same (up to a twist of the $E$-part), and taking vertical homology in the $i$'th spot gives $\HH(C^*_j)=\oplus_{\ell} H^i(\cE_\ell)\otimes_k E(\ell;-j)$.  Since the vertical differentials are defined entirely over $k$, we can still choose a splitting of the homology into the Cech complex, and thus obtain a splitting for the vertical homology in this double complex.  We apply~\cite[Lemma~3.5]{EFS}, to get a complex of $E$-modules:
\[
\cdots \overset{\partial}{\longrightarrow} G(0;-1) \overset{\partial}{\longrightarrow} G \overset{\partial}{\longrightarrow}G(0;1) \overset{\partial}{\longrightarrow} \cdots
\]
where $G$ in homological degree $0$ is
\[
G = \oplus_{i=0}^{\dim X} \HH^i(F^*_i) =  \oplus_{i=0}^{\dim X}\oplus_{\ell \in \Pic(X)} H^i(\cE_\ell )\otimes_k E(\ell;-i).
\]
We thus obtain a well-defined element of $\DM^\circ(E)$ as desired.  To check exactness, we can consider the commutative square
\[
\xymatrix{
\DM_{\free}(\PP^n_E)\ar[r]\ar[d]_{\tau_*} &\DM(\PP^n_k)\ar[d]_{\pi_*}\\
\DM^\circ(E)\ar[r]&\DM^\circ(k)
}
\]
where the horizontal arrows simply forget the $E$-module structure.  Since forgetful maps respect exactness, exactness for part (2) follows from exactness for part (1).
\end{proof}


\fi
%%%%%%%%%%%



\bibliographystyle{amsalpha}
\bibliography{Bibliography}










\end{document}


